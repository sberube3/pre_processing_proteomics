---
title: "B_A_simulation"
output: pdf_document
---

Simulation where both arrays are drawn from the same distribution. 


```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(MASS)
library(DescTools)
library(EnvStats)


n_sim<- 1000


dif_mean_rlm<- rep(NA,n_sim)
dif_mean_std<- rep(NA,n_sim)
dif_mean_med<- rep(NA,n_sim)
dif_mean_wins<- rep(NA,n_sim)
dif_mean_quant<- rep(NA,n_sim)
dif_mean_vsn<- rep(NA,n_sim)
dif_mean_cl<- rep(NA,n_sim)

cv_rlm<- rep(NA,n_sim)
cv_std<- rep(NA, n_sim)
cv_med<- rep(NA, n_sim)
cv_wins<- rep(NA, n_sim)
cv_quant<- rep(NA, n_sim)
cv_vsn<- rep(NA, n_sim)
cv_cl<- rep(NA, n_sim)

mse_rlm_mean<- rep(NA,n_sim)
mse_std_mean<- rep(NA, n_sim)
mse_med_mean<- rep(NA, n_sim)
mse_wins_mean<- rep(NA, n_sim)
mse_quant_mean<- rep(NA, n_sim)
mse_vsn_mean<- rep(NA, n_sim)
mse_cl_mean<- rep(NA, n_sim)

mse_rlm_var<- rep(NA,n_sim)
mse_std_var<- rep(NA, n_sim)
mse_med_var<- rep(NA, n_sim)
mse_wins_var<- rep(NA, n_sim)
mse_quant_var<- rep(NA, n_sim)
mse_vsn_var<- rep(NA, n_sim)
mse_cl_var<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 1000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rlnorm(n_test,0,1.5)

Y_A<- B_S_A*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rlnorm(n_test,0,1.5)

Y_B<- B_S_B*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rlnorm(n_test,0,1.5)

Y_C<- B_S_C*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rlnorm(n_test,0,1.5)

Y_D<- B_S_D*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rlnorm(n_test,0,1.5)

Y_E<- B_S_E*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-4
n_ctrl_TTBS<- 32
n_noDNA<- 24

blank_A<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_A<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_A<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_A<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_A<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_A<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_A<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_A<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_A<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_A<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_A<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_A<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_A<- runif(n_ctrl_small,63.9,66.3)

no_DNA_A<- runif(n_noDNA,10.1,11.1)
ttbs_A<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_A<- c(blank_A,A_igg_003_A,A_igg_03_A,A_igg_3_A,Igg_mix_003_A,
           Igg_mix_03_A,Igg_mix_3_A,A_igg_001_A,A_igg_01_A,A_igg_1_A,
           Igg_mix_001_A,Igg_mix_01_A,Igg_mix_1_A,no_DNA_A,ttbs_A)


blank_B<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_B<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_B<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_B<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_B<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_B<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_B<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_B<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_B<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_B<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_B<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_B<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_B<- runif(n_ctrl_small,63.9,66.3)

no_DNA_B<- runif(n_noDNA,10.1,11.1)
ttbs_B<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_B<- c(blank_B,A_igg_003_B,A_igg_03_B,A_igg_3_B,Igg_mix_003_B,
           Igg_mix_03_B,Igg_mix_3_B,A_igg_001_B,A_igg_01_B,A_igg_1_B,
           Igg_mix_001_B,Igg_mix_01_B,Igg_mix_1_B,no_DNA_B,ttbs_B)




blank_C<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_C<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_C<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_C<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_C<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_C<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_C<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_C<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_C<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_C<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_C<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_C<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_C<- runif(n_ctrl_small,63.9,66.3)

no_DNA_C<- runif(n_noDNA,10.1,11.1)
ttbs_C<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_C<- c(blank_C,A_igg_003_C,A_igg_03_C,A_igg_3_C,Igg_mix_003_C,
           Igg_mix_03_C,Igg_mix_3_C,A_igg_001_C,A_igg_01_C,A_igg_1_C,
           Igg_mix_001_C,Igg_mix_01_C,Igg_mix_1_C,no_DNA_C,ttbs_C)


blank_D<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_D<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_D<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_D<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_D<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_D<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_D<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_D<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_D<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_D<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_D<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_D<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_D<- runif(n_ctrl_small,63.9,66.3)

no_DNA_D<- runif(n_noDNA,10.1,11.1)
ttbs_D<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_D<- c(blank_D,A_igg_003_D,A_igg_03_D,A_igg_3_D,Igg_mix_003_D,
           Igg_mix_03_D,Igg_mix_3_D,A_igg_001_D,A_igg_01_D,A_igg_1_D,
           Igg_mix_001_D,Igg_mix_01_D,Igg_mix_1_D,no_DNA_D,ttbs_D)


blank_E<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_E<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_E<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_E<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_E<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_E<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_E<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_E<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_E<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_E<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_E<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_E<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_E<- runif(n_ctrl_small,63.9,66.3)

no_DNA_E<- runif(n_noDNA,10.1,11.1)
ttbs_E<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_E<- c(blank_E,A_igg_003_E,A_igg_03_E,A_igg_3_E,Igg_mix_003_E,
           Igg_mix_03_E,Igg_mix_3_E,A_igg_001_E,A_igg_01_E,A_igg_1_E,
           Igg_mix_001_E,Igg_mix_01_E,Igg_mix_1_E,no_DNA_E,ttbs_E)



###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,n_ctrl_small*13),rep(1,n_noDNA),rep(0,n_ctrl_TTBS)),
c(rep(0,n_ctrl_small*13),rep(0,n_noDNA),rep(1,n_ctrl_TTBS)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:19])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[1001:1108])
sd_A<- sd(corrected_log_Y_A[1001:1108])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[1001:1108])
sd_B<- sd(corrected_log_Y_B[1001:1108])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[1001:1108])
sd_C<- sd(corrected_log_Y_C[1001:1108])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[1001:1108])
sd_D<- sd(corrected_log_Y_D[1001:1108])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[1001:1108])
sd_E<- sd(corrected_log_Y_E[1001:1108])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E


#########################

med_A<- median(corrected_log_Y_A[1001:1108])
IQR_A<- IQR(corrected_log_Y_A[1001:1108])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[1001:1108])
IQR_B<- IQR(corrected_log_Y_B[1001:1108])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[1001:1108])
IQR_C<- IQR(corrected_log_Y_C[1001:1108])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[1001:1108])
IQR_D<- IQR(corrected_log_Y_D[1001:1108])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[1001:1108])
IQR_E<- sd(corrected_log_Y_E[1001:1108])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[1001:1108]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[1001:1108]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[1001:1108]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[1001:1108]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[1001:1108]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[1001:1108]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[1001:1108]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[1001:1108]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[1001:1108]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[1001:1108]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

################################
#quantile
library(preprocessCore)
log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 
library(limma)
vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)

############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)





med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)




wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)

############
#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)

########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_med[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_wins[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_quant[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)

############################

cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)

cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)

cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)



#cv_quant_AB<- cv(x=c(sort(quantile_matrix[,1])-sort(quantile_matrix[,2])))
#cv_quant_AC<- cv(x=c(sort(quantile_matrix[,1])-sort(quantile_matrix[,3])))
#cv_quant_AD<- cv(x=c(sort(quantile_matrix[,1])-sort(quantile_matrix[,4])))
#cv_quant_AE<- cv(x=c(sort(quantile_matrix[,1])-sort(quantile_matrix[,5])))
#cv_quant_BC<- cv(x=c(sort(quantile_matrix[,2])-sort(quantile_matrix[,3])))
#cv_quant_BD<- cv(x=c(sort(quantile_matrix[,2])-sort(quantile_matrix[,4])))
#cv_quant_BE<- cv(x=c(sort(quantile_matrix[,2])-sort(quantile_matrix[,5])))
#cv_quant_CD<- cv(x=c(sort(quantile_matrix[,3])-sort(quantile_matrix[,4])))
#cv_quant_CE<- cv(x=c(sort(quantile_matrix[,3])-sort(quantile_matrix[,5])))
#cv_quant_DE<- cv(x=c(sort(quantile_matrix[,4])-sort(quantile_matrix[,5])))

#cv_quant[r]<- mean(cv_quant_AB,cv_quant_AC,cv_quant_AD,cv_quant_AE,
                 #cv_quant_BC,cv_quant_BD,cv_quant_BE,
                 #cv_quant_CD,cv_quant_CE,
                 #cv_quant_DE)


cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)

dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)



dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)



dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)






dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)

}






```

```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}

n_sim<- 1000

dif_mean_rlm_dif<- rep(NA,n_sim)
dif_mean_std_dif<- rep(NA,n_sim)
dif_mean_med_dif<- rep(NA,n_sim)
dif_mean_wins_dif<- rep(NA,n_sim)
dif_mean_quant_dif<- rep(NA,n_sim)
dif_mean_vsn_dif<- rep(NA,n_sim)
dif_mean_cl_dif<- rep(NA,n_sim)


cv_rlm_dif<- rep(NA,n_sim)
cv_std_dif<- rep(NA, n_sim)
cv_med_dif<- rep(NA, n_sim)
cv_wins_dif<- rep(NA, n_sim)
cv_quant_dif<- rep(NA, n_sim)
cv_vsn_dif<- rep(NA, n_sim)
cv_cl_dif<- rep(NA, n_sim)


mse_rlm_mean_dif<- rep(NA,n_sim)
mse_std_mean_dif<- rep(NA, n_sim)
mse_med_mean_dif<- rep(NA, n_sim)
mse_wins_mean_dif<- rep(NA, n_sim)
mse_quant_mean_dif<- rep(NA, n_sim)
mse_vsn_mean_dif<- rep(NA, n_sim)
mse_cl_mean_dif<- rep(NA, n_sim)

mse_rlm_var_dif<- rep(NA,n_sim)
mse_std_var_dif<- rep(NA, n_sim)
mse_med_var_dif<- rep(NA, n_sim)
mse_wins_var_dif<- rep(NA, n_sim)
mse_quant_var_dif<- rep(NA, n_sim)
mse_vsn_var_dif<- rep(NA, n_sim)
mse_cl_var_dif<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 1000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rlnorm(n_test,0,1.5)

Y_A<- B_S_A*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rlnorm(n_test,0.25,2)

Y_B<- B_S_B*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rlnorm(n_test,0.5,2)

Y_C<- B_S_C*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rlnorm(n_test,0.75,2)

Y_D<- B_S_D*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rlnorm(n_test,1,2)

Y_E<- B_S_E*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-4
n_ctrl_TTBS<- 32
n_noDNA<- 24

blank_A<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_A<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_A<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_A<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_A<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_A<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_A<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_A<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_A<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_A<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_A<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_A<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_A<- runif(n_ctrl_small,63.9,66.3)

no_DNA_A<- runif(n_noDNA,10.1,11.1)
ttbs_A<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_A<- c(blank_A,A_igg_003_A,A_igg_03_A,A_igg_3_A,Igg_mix_003_A,
           Igg_mix_03_A,Igg_mix_3_A,A_igg_001_A,A_igg_01_A,A_igg_1_A,
           Igg_mix_001_A,Igg_mix_01_A,Igg_mix_1_A,no_DNA_A,ttbs_A)


blank_B<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_B<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_B<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_B<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_B<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_B<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_B<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_B<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_B<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_B<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_B<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_B<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_B<- runif(n_ctrl_small,63.9,66.3)

no_DNA_B<- runif(n_noDNA,10.1,11.1)
ttbs_B<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_B<- c(blank_B,A_igg_003_B,A_igg_03_B,A_igg_3_B,Igg_mix_003_B,
           Igg_mix_03_B,Igg_mix_3_B,A_igg_001_B,A_igg_01_B,A_igg_1_B,
           Igg_mix_001_B,Igg_mix_01_B,Igg_mix_1_B,no_DNA_B,ttbs_B)*1.65




blank_C<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_C<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_C<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_C<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_C<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_C<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_C<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_C<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_C<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_C<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_C<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_C<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_C<- runif(n_ctrl_small,63.9,66.3)

no_DNA_C<- runif(n_noDNA,10.1,11.1)
ttbs_C<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_C<- c(blank_C,A_igg_003_C,A_igg_03_C,A_igg_3_C,Igg_mix_003_C,
           Igg_mix_03_C,Igg_mix_3_C,A_igg_001_C,A_igg_01_C,A_igg_1_C,
           Igg_mix_001_C,Igg_mix_01_C,Igg_mix_1_C,no_DNA_C,ttbs_C)*2.12


blank_D<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_D<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_D<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_D<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_D<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_D<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_D<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_D<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_D<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_D<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_D<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_D<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_D<- runif(n_ctrl_small,63.9,66.3)

no_DNA_D<- runif(n_noDNA,10.1,11.1)
ttbs_D<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_D<- c(blank_D,A_igg_003_D,A_igg_03_D,A_igg_3_D,Igg_mix_003_D,
           Igg_mix_03_D,Igg_mix_3_D,A_igg_001_D,A_igg_01_D,A_igg_1_D,
           Igg_mix_001_D,Igg_mix_01_D,Igg_mix_1_D,no_DNA_D,ttbs_D)*2.72


blank_E<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_E<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_E<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_E<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_E<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_E<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_E<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_E<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_E<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_E<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_E<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_E<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_E<- runif(n_ctrl_small,63.9,66.3)

no_DNA_E<- runif(n_noDNA,10.1,11.1)
ttbs_E<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_E<- c(blank_E,A_igg_003_E,A_igg_03_E,A_igg_3_E,Igg_mix_003_E,
           Igg_mix_03_E,Igg_mix_3_E,A_igg_001_E,A_igg_01_E,A_igg_1_E,
           Igg_mix_001_E,Igg_mix_01_E,Igg_mix_1_E,no_DNA_E,ttbs_E)*3.5



###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,n_ctrl_small*13),rep(1,n_noDNA),rep(0,n_ctrl_TTBS)),
c(rep(0,n_ctrl_small*13),rep(0,n_noDNA),rep(1,n_ctrl_TTBS)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:19])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[1001:1108])
sd_A<- sd(corrected_log_Y_A[1001:1108])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[1001:1108])
sd_B<- sd(corrected_log_Y_B[1001:1108])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[1001:1108])
sd_C<- sd(corrected_log_Y_C[1001:1108])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[1001:1108])
sd_D<- sd(corrected_log_Y_D[1001:1108])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[1001:1108])
sd_E<- sd(corrected_log_Y_E[1001:1108])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################

med_A<- median(corrected_log_Y_A[1001:1108])
IQR_A<- IQR(corrected_log_Y_A[1001:1108])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[1001:1108])
IQR_B<- IQR(corrected_log_Y_B[1001:1108])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[1001:1108])
IQR_C<- IQR(corrected_log_Y_C[1001:1108])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[1001:1108])
IQR_D<- IQR(corrected_log_Y_D[1001:1108])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[1001:1108])
IQR_E<- IQR(corrected_log_Y_E[1001:1108])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E
################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[1001:1108]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[1001:1108]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[1001:1108]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[1001:1108]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[1001:1108]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[1001:1108]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[1001:1108]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[1001:1108]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[1001:1108]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[1001:1108]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E


log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)


############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)



med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)

wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)
############
#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)

########################################################

########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_dif[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_dif[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_med_dif[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_wins_dif[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_quant_dif[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_dif[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_dif[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

##################################################


cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_dif[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_dif[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)

cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_dif[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)



cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_dif[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)


cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_dif[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_dif[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)

dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_dif[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_dif[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_dif[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)


dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_dif[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)


dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_dif[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_dif[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)



dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_dif[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)


dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_dif[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)


dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_dif[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_dif[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_dif[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_dif[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_dif[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_dif[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)


}

```

Model, misspecification simulation but with same distributions. 

```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}


n_sim<- 1000

dif_mean_rlm_misspecified<- rep(NA,n_sim)
dif_mean_std_misspecified<- rep(NA,n_sim)
dif_mean_med_misspecified<- rep(NA,n_sim)
dif_mean_wins_misspecified<- rep(NA,n_sim)
dif_mean_quant_misspecified<- rep(NA,n_sim)
dif_mean_vsn_misspecified<- rep(NA,n_sim)
dif_mean_cl_misspecified<- rep(NA,n_sim)

cv_rlm_mis<- rep(NA,n_sim)
cv_std_mis<- rep(NA, n_sim)
cv_med_mis<- rep(NA, n_sim)
cv_wins_mis<- rep(NA, n_sim)
cv_quant_mis<- rep(NA, n_sim)
cv_vsn_mis<- rep(NA, n_sim)
cv_cl_mis<- rep(NA, n_sim)

mse_rlm_mean_mis<- rep(NA,n_sim)
mse_std_mean_mis<- rep(NA, n_sim)
mse_med_mean_mis<- rep(NA, n_sim)
mse_wins_mean_mis<- rep(NA, n_sim)
mse_quant_mean_mis<- rep(NA, n_sim)
mse_vsn_mean_mis<- rep(NA, n_sim)
mse_cl_mean_mis<- rep(NA, n_sim)

mse_rlm_var_mis<- rep(NA,n_sim)
mse_std_var_mis<- rep(NA, n_sim)
mse_med_var_mis<- rep(NA, n_sim)
mse_wins_var_mis<- rep(NA, n_sim)
mse_quant_var_mis<- rep(NA, n_sim)
mse_vsn_var_mis<- rep(NA, n_sim)
mse_cl_var_mis<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 1000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rnorm(n_test,0,1.5)

Y_A<- ((B_S_A)^2)*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rnorm(n_test,0,1.5)

Y_B<- ((B_S_B)^2)*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rnorm(n_test,0,1.5)

Y_C<- ((B_S_C)^2)*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rnorm(n_test,0,1.5)

Y_D<- ((B_S_D)^2)*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rnorm(n_test,0,1.5)

Y_E<- ((B_S_E)^2)*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-4
n_ctrl_TTBS<- 32
n_noDNA<- 24

blank_A<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_A<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_A<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_A<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_A<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_A<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_A<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_A<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_A<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_A<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_A<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_A<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_A<- runif(n_ctrl_small,63.9,66.3)

no_DNA_A<- runif(n_noDNA,10.1,11.1)
ttbs_A<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_A<- c(blank_A,A_igg_003_A,A_igg_03_A,A_igg_3_A,Igg_mix_003_A,
           Igg_mix_03_A,Igg_mix_3_A,A_igg_001_A,A_igg_01_A,A_igg_1_A,
           Igg_mix_001_A,Igg_mix_01_A,Igg_mix_1_A,no_DNA_A,ttbs_A)^2


blank_B<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_B<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_B<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_B<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_B<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_B<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_B<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_B<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_B<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_B<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_B<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_B<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_B<- runif(n_ctrl_small,63.9,66.3)

no_DNA_B<- runif(n_noDNA,10.1,11.1)
ttbs_B<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_B<- c(blank_B,A_igg_003_B,A_igg_03_B,A_igg_3_B,Igg_mix_003_B,
           Igg_mix_03_B,Igg_mix_3_B,A_igg_001_B,A_igg_01_B,A_igg_1_B,
           Igg_mix_001_B,Igg_mix_01_B,Igg_mix_1_B,no_DNA_B,ttbs_B)^2




blank_C<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_C<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_C<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_C<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_C<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_C<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_C<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_C<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_C<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_C<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_C<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_C<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_C<- runif(n_ctrl_small,63.9,66.3)

no_DNA_C<- runif(n_noDNA,10.1,11.1)
ttbs_C<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_C<- c(blank_C,A_igg_003_C,A_igg_03_C,A_igg_3_C,Igg_mix_003_C,
           Igg_mix_03_C,Igg_mix_3_C,A_igg_001_C,A_igg_01_C,A_igg_1_C,
           Igg_mix_001_C,Igg_mix_01_C,Igg_mix_1_C,no_DNA_C,ttbs_C)^2


blank_D<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_D<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_D<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_D<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_D<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_D<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_D<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_D<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_D<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_D<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_D<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_D<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_D<- runif(n_ctrl_small,63.9,66.3)

no_DNA_D<- runif(n_noDNA,10.1,11.1)
ttbs_D<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_D<- c(blank_D,A_igg_003_D,A_igg_03_D,A_igg_3_D,Igg_mix_003_D,
           Igg_mix_03_D,Igg_mix_3_D,A_igg_001_D,A_igg_01_D,A_igg_1_D,
           Igg_mix_001_D,Igg_mix_01_D,Igg_mix_1_D,no_DNA_D,ttbs_D)^2


blank_E<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_E<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_E<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_E<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_E<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_E<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_E<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_E<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_E<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_E<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_E<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_E<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_E<- runif(n_ctrl_small,63.9,66.3)

no_DNA_E<- runif(n_noDNA,10.1,11.1)
ttbs_E<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_E<- c(blank_E,A_igg_003_E,A_igg_03_E,A_igg_3_E,Igg_mix_003_E,
           Igg_mix_03_E,Igg_mix_3_E,A_igg_001_E,A_igg_01_E,A_igg_1_E,
           Igg_mix_001_E,Igg_mix_01_E,Igg_mix_1_E,no_DNA_E,ttbs_E)^2



###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,n_ctrl_small*13),rep(1,n_noDNA),rep(0,n_ctrl_TTBS)),
c(rep(0,n_ctrl_small*13),rep(0,n_noDNA),rep(1,n_ctrl_TTBS)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:19])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[1001:1108])
sd_A<- sd(corrected_log_Y_A[1001:1108])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[1001:1108])
sd_B<- sd(corrected_log_Y_B[1001:1108])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[1001:1108])
sd_C<- sd(corrected_log_Y_C[1001:1108])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[1001:1108])
sd_D<- sd(corrected_log_Y_D[1001:1108])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[1001:1108])
sd_E<- sd(corrected_log_Y_E[1001:1108])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################

med_A<- median(corrected_log_Y_A[1001:1108])
IQR_A<- IQR(corrected_log_Y_A[1001:1108])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[1001:1108])
IQR_B<- IQR(corrected_log_Y_B[1001:1108])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[1001:1108])
IQR_C<- IQR(corrected_log_Y_C[1001:1108])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[1001:1108])
IQR_D<- IQR(corrected_log_Y_D[1001:1108])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[1001:1108])
IQR_E<- IQR(corrected_log_Y_E[1001:1108])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

####################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[1001:1108]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[1001:1108]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[1001:1108]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[1001:1108]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[1001:1108]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[1001:1108]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[1001:1108]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[1001:1108]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[1001:1108]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[1001:1108]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)


############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)
#######################

med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)
##############################

wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)

############
#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)

########################################################


########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_misspecified[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_misspecified[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_med_misspecified[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_wins_misspecified[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_quant_misspecified[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_misspecified[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_misspecified[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

##################################################


cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_mis[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_mis[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)



cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_mis[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)


cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_mis[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)



cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_mis[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_mis[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)


dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_mis[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_mis[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_mis[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_mis[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)



dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_mis[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_mis[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)



dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_mis[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_mis[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)


dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_mis[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_mis[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_mis[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_mis[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_mis[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_mis[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)




}

```

Model, misspecification simulation but with different distributions. 

```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(MASS)

n_sim<- 1000

dif_mean_rlm_misspecified_dif<- rep(NA,n_sim)
dif_mean_std_misspecified_dif<- rep(NA,n_sim)
dif_mean_med_misspecified_dif<- rep(NA,n_sim)
dif_mean_wins_misspecified_dif<- rep(NA,n_sim)
dif_mean_quant_misspecified_dif<- rep(NA,n_sim)
dif_mean_vsn_misspecified_dif<- rep(NA,n_sim)
dif_mean_cl_misspecified_dif<- rep(NA,n_sim)

cv_rlm_mis_dif<- rep(NA,n_sim)
cv_std_mis_dif<- rep(NA, n_sim)
cv_med_mis_dif<- rep(NA, n_sim)
cv_wins_mis_dif<- rep(NA, n_sim)
cv_quant_mis_dif<- rep(NA, n_sim)
cv_vsn_mis_dif<- rep(NA, n_sim)
cv_cl_mis_dif<- rep(NA, n_sim)

mse_rlm_mean_mis_dif<- rep(NA,n_sim)
mse_std_mean_mis_dif<- rep(NA, n_sim)
mse_med_mean_mis_dif<- rep(NA, n_sim)
mse_wins_mean_mis_dif<- rep(NA, n_sim)
mse_quant_mean_mis_dif<- rep(NA, n_sim)
mse_vsn_mean_mis_dif<- rep(NA, n_sim)
mse_cl_mean_mis_dif<- rep(NA, n_sim)

mse_rlm_var_mis_dif<- rep(NA,n_sim)
mse_std_var_mis_dif<- rep(NA, n_sim)
mse_med_var_mis_dif<- rep(NA, n_sim)
mse_wins_var_mis_dif<- rep(NA, n_sim)
mse_quant_var_mis_dif<- rep(NA, n_sim)
mse_vsn_var_mis_dif<- rep(NA, n_sim)
mse_cl_var_mis_dif<- rep(NA, n_sim)


for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 1000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rnorm(n_test,0,1.5)

Y_A<- ((B_S_A)^2)*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rnorm(n_test,0.25,2)

Y_B<- ((B_S_B)^2)*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rnorm(n_test,0.5,2)

Y_C<- ((B_S_C)^2)*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rnorm(n_test,0.75,2)

Y_D<- ((B_S_D)^2)*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rnorm(n_test,1,2)

Y_E<- ((B_S_E)^2)*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-4
n_ctrl_TTBS<- 32
n_noDNA<- 24

blank_A<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_A<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_A<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_A<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_A<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_A<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_A<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_A<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_A<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_A<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_A<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_A<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_A<- runif(n_ctrl_small,63.9,66.3)

no_DNA_A<- runif(n_noDNA,10.1,11.1)
ttbs_A<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_A<- c(blank_A,A_igg_003_A,A_igg_03_A,A_igg_3_A,Igg_mix_003_A,
           Igg_mix_03_A,Igg_mix_3_A,A_igg_001_A,A_igg_01_A,A_igg_1_A,
           Igg_mix_001_A,Igg_mix_01_A,Igg_mix_1_A,no_DNA_A,ttbs_A)^2


blank_B<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_B<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_B<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_B<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_B<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_B<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_B<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_B<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_B<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_B<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_B<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_B<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_B<- runif(n_ctrl_small,63.9,66.3)

no_DNA_B<- runif(n_noDNA,10.1,11.1)
ttbs_B<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_B<- ((c(blank_B,A_igg_003_B,A_igg_03_B,A_igg_3_B,Igg_mix_003_B,
           Igg_mix_03_B,Igg_mix_3_B,A_igg_001_B,A_igg_01_B,A_igg_1_B,
           Igg_mix_001_B,Igg_mix_01_B,Igg_mix_1_B,no_DNA_B,ttbs_B)+0.25)*1.3)^2




blank_C<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_C<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_C<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_C<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_C<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_C<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_C<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_C<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_C<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_C<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_C<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_C<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_C<- runif(n_ctrl_small,63.9,66.3)

no_DNA_C<- runif(n_noDNA,10.1,11.1)
ttbs_C<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_C<- ((c(blank_C,A_igg_003_C,A_igg_03_C,A_igg_3_C,Igg_mix_003_C,
           Igg_mix_03_C,Igg_mix_3_C,A_igg_001_C,A_igg_01_C,A_igg_1_C,
           Igg_mix_001_C,Igg_mix_01_C,Igg_mix_1_C,no_DNA_C,ttbs_C)+0.5)*1.3)^2


blank_D<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_D<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_D<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_D<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_D<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_D<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_D<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_D<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_D<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_D<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_D<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_D<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_D<- runif(n_ctrl_small,63.9,66.3)

no_DNA_D<- runif(n_noDNA,10.1,11.1)
ttbs_D<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_D<- ((c(blank_D,A_igg_003_D,A_igg_03_D,A_igg_3_D,Igg_mix_003_D,
           Igg_mix_03_D,Igg_mix_3_D,A_igg_001_D,A_igg_01_D,A_igg_1_D,
           Igg_mix_001_D,Igg_mix_01_D,Igg_mix_1_D,no_DNA_D,ttbs_D)+0.75)*1.3)^2


blank_E<- runif(n_ctrl_small,0.88,0.92)

A_igg_003_E<- runif(n_ctrl_small,6.2,8.4)
A_igg_03_E<- runif(n_ctrl_small,33.8,42.3)
A_igg_3_E<- runif(n_ctrl_small,247.3,263.7)

Igg_mix_003_E<- runif(n_ctrl_small,11.2,13.3)
Igg_mix_03_E<- runif(n_ctrl_small,41.2,45.8)
Igg_mix_3_E<- runif(n_ctrl_small,85.6,87.3)

A_igg_001_E<- runif(n_ctrl_small,3.2,4.4)
A_igg_01_E<- runif(n_ctrl_small,14.16,19.2)
A_igg_1_E<- runif(n_ctrl_small,59.1,70.2)

Igg_mix_001_E<- runif(n_ctrl_small,4.2,6.2)
Igg_mix_01_E<- runif(n_ctrl_small,23.5,26.1)
Igg_mix_1_E<- runif(n_ctrl_small,63.9,66.3)

no_DNA_E<- runif(n_noDNA,10.1,11.1)
ttbs_E<- runif(n_ctrl_TTBS,1.3,3.3)

ctrl_E<- ((c(blank_E,A_igg_003_E,A_igg_03_E,A_igg_3_E,Igg_mix_003_E,
           Igg_mix_03_E,Igg_mix_3_E,A_igg_001_E,A_igg_01_E,A_igg_1_E,
           Igg_mix_001_E,Igg_mix_01_E,Igg_mix_1_E,no_DNA_E,ttbs_E)+1)*1.3)^2



###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,n_ctrl_small*13),rep(1,n_noDNA),rep(0,n_ctrl_TTBS)),
c(rep(0,n_ctrl_small*13),rep(0,n_noDNA),rep(1,n_ctrl_TTBS)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:19])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[1001:1108])
sd_A<- sd(corrected_log_Y_A[1001:1108])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[1001:1108])
sd_B<- sd(corrected_log_Y_B[1001:1108])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[1001:1108])
sd_C<- sd(corrected_log_Y_C[1001:1108])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[1001:1108])
sd_D<- sd(corrected_log_Y_D[1001:1108])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[1001:1108])
sd_E<- sd(corrected_log_Y_E[1001:1108])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################


med_A<- median(corrected_log_Y_A[1001:1108])
IQR_A<- IQR(corrected_log_Y_A[1001:1108])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[1001:1108])
IQR_B<- IQR(corrected_log_Y_B[1001:1108])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[1001:1108])
IQR_C<- IQR(corrected_log_Y_C[1001:1108])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[1001:1108])
IQR_D<- IQR(corrected_log_Y_D[1001:1108])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[1001:1108])
IQR_E<- IQR(corrected_log_Y_E[1001:1108])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

###################################################


wins_mean_A<- mean(Winsorize(corrected_log_Y_A[1001:1108]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[1001:1108]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[1001:1108]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[1001:1108]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[1001:1108]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[1001:1108]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[1001:1108]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[1001:1108]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[1001:1108]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[1001:1108]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)


############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)



med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)



wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)

############
#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)

########################################################

########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_misspecified_dif[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_misspecified_dif[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_med_misspecified_dif[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_wins_misspecified_dif[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_quant_misspecified_dif[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_misspecified_dif[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_misspecified_dif[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

##################################################


cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_mis_dif[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_mis_dif[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)


cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_mis_dif[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)


cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_mis_dif[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)


cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_mis_dif[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_mis_dif[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)


dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_mis_dif[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_mis_dif[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_mis_dif[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_mis_dif[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)


dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_mis_dif[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_mis_dif[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)


dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_mis_dif[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_mis_dif[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)



dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_mis_dif[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_mis_dif[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_mis_dif[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_mis_dif[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_mis_dif[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_mis_dif[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)


}

```




```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(MASS)

n_sim<- 1000

dif_mean_rlm_hp<- rep(NA,n_sim)
dif_mean_std_hp<- rep(NA,n_sim)
dif_mean_med_hp<- rep(NA,n_sim)
dif_mean_wins_hp<- rep(NA,n_sim)
dif_mean_quant_hp<- rep(NA,n_sim)
dif_mean_vsn_hp<- rep(NA,n_sim)
dif_mean_cl_hp<- rep(NA,n_sim)

cv_rlm_hp<- rep(NA,n_sim)
cv_std_hp<- rep(NA, n_sim)
cv_med_hp<- rep(NA, n_sim)
cv_wins_hp<- rep(NA, n_sim)
cv_quant_hp<- rep(NA, n_sim)
cv_vsn_hp<- rep(NA, n_sim)
cv_cl_hp<- rep(NA, n_sim)

mse_rlm_mean_hp<- rep(NA,n_sim)
mse_std_mean_hp<- rep(NA, n_sim)
mse_med_mean_hp<- rep(NA, n_sim)
mse_wins_mean_hp<- rep(NA, n_sim)
mse_quant_mean_hp<- rep(NA, n_sim)
mse_vsn_mean_hp<- rep(NA, n_sim)
mse_cl_mean_hp<- rep(NA, n_sim)

mse_rlm_var_hp<- rep(NA,n_sim)
mse_std_var_hp<- rep(NA, n_sim)
mse_med_var_hp<- rep(NA, n_sim)
mse_wins_var_hp<- rep(NA, n_sim)
mse_quant_var_hp<- rep(NA, n_sim)
mse_vsn_var_hp<- rep(NA, n_sim)
mse_cl_var_hp<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 10000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rlnorm(n_test,0,1.5)

Y_A<- B_S_A*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rlnorm(n_test,0,1.5)

Y_B<- B_S_B*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rlnorm(n_test,0,1.5)

Y_C<- B_S_C*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rlnorm(n_test,0,1.5)

Y_D<- B_S_D*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rlnorm(n_test,0,1.5)

Y_E<- B_S_E*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-48
n_ctrl_buffer<- 816
n_empty<- 3072

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_A<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)


H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_B<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)



H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_C<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_D<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_E<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)


###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,(n_ctrl_small*13)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*14))),
c(rep(0,n_ctrl_small*14),rep(1,n_ctrl_buffer),rep(0,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(1,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(0,n_empty),rep(1,n_ctrl_small)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:21])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[10001:14608])
sd_A<- sd(corrected_log_Y_A[10001:14608])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[10001:14608])
sd_B<- sd(corrected_log_Y_B[10001:14608])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[10001:14608])
sd_C<- sd(corrected_log_Y_C[10001:14608])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[10001:14608])
sd_D<- sd(corrected_log_Y_D[10001:14608])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[10001:14608])
sd_E<- sd(corrected_log_Y_E[10001:14608])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################
med_A<- median(corrected_log_Y_A[10001:14608])
IQR_A<- IQR(corrected_log_Y_A[10001:14608])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[10001:14608])
IQR_B<- IQR(corrected_log_Y_B[10001:14608])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[10001:14608])
IQR_C<- IQR(corrected_log_Y_C[10001:14608])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[10001:14608])
IQR_D<- IQR(corrected_log_Y_D[10001:14608])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[10001:14608])
IQR_E<- IQR(corrected_log_Y_E[10001:14608])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

#########################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[10001:14608]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[10001:14608]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[10001:14608]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[10001:14608]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[10001:14608]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[10001:14608]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[10001:14608]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[10001:14608]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[10001:14608]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[10001:14608]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)



############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)



med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)




wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)

#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)

########################################################

########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_hp[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_hp[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_med_hp[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_wins_hp[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_quant_hp[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_hp[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_hp[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

################################

cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_hp[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_hp[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)


cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_hp[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)


cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_hp[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)



cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_hp[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_hp[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)



dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_hp[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_hp[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_hp[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_hp[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)


dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_hp[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_hp[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)



dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_hp[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_hp[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)



dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_hp[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_hp[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_hp[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_hp[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_hp[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_hp[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)

}

```


```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(MASS)

n_sim<- 1000

dif_mean_rlm_hp_dif<- rep(NA,n_sim)
dif_mean_std_hp_dif<- rep(NA,n_sim)
dif_mean_med_hp_dif<- rep(NA,n_sim)
dif_mean_wins_hp_dif<- rep(NA,n_sim)
dif_mean_quant_hp_dif<- rep(NA,n_sim)
dif_mean_vsn_hp_dif<- rep(NA,n_sim)
dif_mean_cl_hp_dif<- rep(NA,n_sim)

cv_rlm_hp_dif<- rep(NA,n_sim)
cv_std_hp_dif<- rep(NA, n_sim)
cv_med_hp_dif<- rep(NA, n_sim)
cv_wins_hp_dif<- rep(NA, n_sim)
cv_quant_hp_dif<- rep(NA, n_sim)
cv_vsn_hp_dif<- rep(NA, n_sim)
cv_cl_hp_dif<- rep(NA, n_sim)

mse_rlm_mean_hp_dif<- rep(NA,n_sim)
mse_std_mean_hp_dif<- rep(NA, n_sim)
mse_med_mean_hp_dif<- rep(NA, n_sim)
mse_wins_mean_hp_dif<- rep(NA, n_sim)
mse_quant_mean_hp_dif<- rep(NA, n_sim)
mse_vsn_mean_hp_dif<- rep(NA, n_sim)
mse_cl_mean_hp_dif<- rep(NA, n_sim)

mse_rlm_var_hp_dif<- rep(NA,n_sim)
mse_std_var_hp_dif<- rep(NA, n_sim)
mse_med_var_hp_dif<- rep(NA, n_sim)
mse_wins_var_hp_dif<- rep(NA, n_sim)
mse_quant_var_hp_dif<- rep(NA, n_sim)
mse_vsn_var_hp_dif<- rep(NA, n_sim)
mse_cl_var_hp_dif<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 10000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rlnorm(n_test,0,1.5)

Y_A<- B_S_A*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rlnorm(n_test,0.25,2)

Y_B<- B_S_B*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rlnorm(n_test,0.5,2)

Y_C<- B_S_C*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rlnorm(n_test,0.75,2)

Y_D<- B_S_D*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rlnorm(n_test,1,2)

Y_E<- B_S_E*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-48
n_ctrl_buffer<- 816
n_empty<- 3072

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_A<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)


H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_B<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)*1.65



H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_C<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)*2.12

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_D<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)*2.72

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_E<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)*3.5


###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,(n_ctrl_small*13)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*14))),
c(rep(0,n_ctrl_small*14),rep(1,n_ctrl_buffer),rep(0,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(1,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(0,n_empty),rep(1,n_ctrl_small)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:21])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[10001:14608])
sd_A<- sd(corrected_log_Y_A[10001:14608])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[10001:14608])
sd_B<- sd(corrected_log_Y_B[10001:14608])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[10001:14608])
sd_C<- sd(corrected_log_Y_C[10001:14608])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[10001:14608])
sd_D<- sd(corrected_log_Y_D[10001:14608])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[10001:14608])
sd_E<- sd(corrected_log_Y_E[10001:14608])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################
med_A<- median(corrected_log_Y_A[10001:14608])
IQR_A<- IQR(corrected_log_Y_A[10001:14608])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[10001:14608])
IQR_B<- IQR(corrected_log_Y_B[10001:14608])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[10001:14608])
IQR_C<- IQR(corrected_log_Y_C[10001:14608])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[10001:14608])
IQR_D<- IQR(corrected_log_Y_D[10001:14608])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[10001:14608])
IQR_E<- IQR(corrected_log_Y_E[10001:14608])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

###########################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[10001:14608]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[10001:14608]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[10001:14608]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[10001:14608]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[10001:14608]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[10001:14608]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[10001:14608]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[10001:14608]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[10001:14608]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[10001:14608]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)


############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)



med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)



wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)


#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)

########################################################

########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_hp_dif[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_hp_dif[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_med_hp_dif[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_wins_hp_dif[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_quant_hp_dif[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_hp_dif[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_hp_dif[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

################################

################################

cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_hp_dif[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_hp_dif[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)

cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_hp_dif[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)

cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_hp_dif[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)


cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_hp_dif[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_hp_dif[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)



dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_hp_dif[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_hp_dif[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_hp_dif[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_hp_dif[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)


dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_hp_dif[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_hp_dif[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)

dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_hp_dif[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_hp_dif[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)




dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_hp_dif[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_hp_dif[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_hp_dif[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_hp_dif[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_hp_dif[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_hp_dif[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)

}

```

Model, misspecification simulation but with same distributions. 


```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(MASS)

n_sim<- 1000

dif_mean_rlm_hp_mis<- rep(NA,n_sim)
dif_mean_std_hp_mis<- rep(NA,n_sim)
dif_mean_med_hp_mis<- rep(NA,n_sim)
dif_mean_wins_hp_mis<- rep(NA,n_sim)
dif_mean_quant_hp_mis<- rep(NA,n_sim)
dif_mean_vsn_hp_mis<- rep(NA,n_sim)
dif_mean_cl_hp_mis<- rep(NA,n_sim)

cv_rlm_hp_mis<- rep(NA,n_sim)
cv_std_hp_mis<- rep(NA, n_sim)
cv_med_hp_mis<- rep(NA, n_sim)
cv_wins_hp_mis<- rep(NA, n_sim)
cv_quant_hp_mis<- rep(NA, n_sim)
cv_vsn_hp_mis<- rep(NA, n_sim)
cv_cl_hp_mis<- rep(NA, n_sim)

mse_rlm_mean_hp_mis<- rep(NA,n_sim)
mse_std_mean_hp_mis<- rep(NA, n_sim)
mse_med_mean_hp_mis<- rep(NA, n_sim)
mse_wins_mean_hp_mis<- rep(NA, n_sim)
mse_quant_mean_hp_mis<- rep(NA, n_sim)
mse_vsn_mean_hp_mis<- rep(NA, n_sim)
mse_cl_mean_hp_mis<- rep(NA, n_sim)

mse_rlm_var_hp_mis<- rep(NA,n_sim)
mse_std_var_hp_mis<- rep(NA, n_sim)
mse_med_var_hp_mis<- rep(NA, n_sim)
mse_wins_var_hp_mis<- rep(NA, n_sim)
mse_quant_var_hp_mis<- rep(NA, n_sim)
mse_vsn_var_hp_mis<- rep(NA, n_sim)
mse_cl_var_hp_mis<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 10000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rnorm(n_test,0,1.5)

Y_A<- ((B_S_A)^2)*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rnorm(n_test,0,1.5)

Y_B<- ((B_S_B)^2)*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rnorm(n_test,0,1.5)

Y_C<- ((B_S_C)^2)*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rnorm(n_test,0,1.5)

Y_D<- ((B_S_D)^2)*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rnorm(n_test,0,1.5)

Y_E<- ((B_S_E)^2)*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-48
n_ctrl_buffer<- 816
n_empty<- 3072

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_A<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)^2


H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_B<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)^2



H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_C<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)^2

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_D<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)^2

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_E<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)^2


###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,(n_ctrl_small*13)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*14))),
c(rep(0,n_ctrl_small*14),rep(1,n_ctrl_buffer),rep(0,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(1,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(0,n_empty),rep(1,n_ctrl_small)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:21])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[10001:14608])
sd_A<- sd(corrected_log_Y_A[10001:14608])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[10001:14608])
sd_B<- sd(corrected_log_Y_B[10001:14608])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[10001:14608])
sd_C<- sd(corrected_log_Y_C[10001:14608])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[10001:14608])
sd_D<- sd(corrected_log_Y_D[10001:14608])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[10001:14608])
sd_E<- sd(corrected_log_Y_E[10001:14608])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################
med_A<- median(corrected_log_Y_A[10001:14608])
IQR_A<- IQR(corrected_log_Y_A[10001:14608])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[10001:14608])
IQR_B<- IQR(corrected_log_Y_B[10001:14608])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[10001:14608])
IQR_C<- IQR(corrected_log_Y_C[10001:14608])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[10001:14608])
IQR_D<- IQR(corrected_log_Y_D[10001:14608])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[10001:14608])
IQR_E<- IQR(corrected_log_Y_E[10001:14608])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

######################################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[10001:14608]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[10001:14608]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[10001:14608]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[10001:14608]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[10001:14608]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[10001:14608]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[10001:14608]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[10001:14608]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[10001:14608]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[10001:14608]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)

############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)







med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)





wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)


#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)


########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_hp_mis[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_hp_mis[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_med_hp_mis[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_wins_hp_mis[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)



dif_mean_quant_hp_mis[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_hp_mis[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_hp_mis[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

################################

################################

cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_hp_mis[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_hp_mis[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)

cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_hp_mis[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)

cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_hp_mis[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)


cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_hp_mis[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_hp_mis[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)




dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_hp_mis[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_hp_mis[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_hp_mis[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_hp_mis[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)

dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_hp_mis[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_hp_mis[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)

dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_hp_mis[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_hp_mis[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)




dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_hp_mis[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_hp_mis[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_hp_mis[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_hp_mis[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_hp_mis[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_hp_mis[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)

}

```


Model, misspecification simulation but with different distributions. 
```{r,cache=TRUE, message=FALSE, warning=FALSE, echo=FALSE}
library(ggplot2)
library(MASS)

n_sim<- 1000

dif_mean_rlm_hp_mis_dif<- rep(NA,n_sim)
dif_mean_std_hp_mis_dif<- rep(NA,n_sim)
dif_mean_med_hp_mis_dif<- rep(NA,n_sim)
dif_mean_wins_hp_mis_dif<- rep(NA,n_sim)
dif_mean_quant_hp_mis_dif<- rep(NA,n_sim)
dif_mean_vsn_hp_mis_dif<- rep(NA,n_sim)
dif_mean_cl_hp_mis_dif<- rep(NA,n_sim)

cv_rlm_hp_mis_dif<- rep(NA,n_sim)
cv_std_hp_mis_dif<- rep(NA, n_sim)
cv_med_hp_mis_dif<- rep(NA, n_sim)
cv_wins_hp_mis_dif<- rep(NA, n_sim)
cv_quant_hp_mis_dif<- rep(NA, n_sim)
cv_vsn_hp_mis_dif<- rep(NA, n_sim)
cv_cl_hp_mis_dif<- rep(NA, n_sim)

mse_rlm_mean_hp_mis_dif<- rep(NA,n_sim)
mse_std_mean_hp_mis_dif<- rep(NA, n_sim)
mse_med_mean_hp_mis_dif<- rep(NA, n_sim)
mse_wins_mean_hp_mis_dif<- rep(NA, n_sim)
mse_quant_mean_hp_mis_dif<- rep(NA, n_sim)
mse_vsn_mean_hp_mis_dif<- rep(NA, n_sim)
mse_cl_mean_hp_mis_dif<- rep(NA, n_sim)

mse_rlm_var_hp_mis_dif<- rep(NA,n_sim)
mse_std_var_hp_mis_dif<- rep(NA, n_sim)
mse_med_var_hp_mis_dif<- rep(NA, n_sim)
mse_wins_var_hp_mis_dif<- rep(NA, n_sim)
mse_quant_var_hp_mis_dif<- rep(NA, n_sim)
mse_vsn_var_hp_mis_dif<- rep(NA, n_sim)
mse_cl_var_hp_mis_dif<- rep(NA, n_sim)

for(r in 1:n_sim){
N<- 1000000

alpha<-2

mesh<- rep(1:N)/(1+N)

pr.mass<- dbeta(mesh,alpha,alpha)

mass<- pr.mass/sum(pr.mass)

Z<- qnorm(mesh)

mean.exp.Z<- sum(mass*exp(Z))

mu<- -log(mean.exp.Z)

mu



n_test<- 10000

u_A<- rbeta(n_test,alpha,alpha)
z_A<- pnorm(u_A,0,1)
e_A<- exp(mu+z_A)
B_S_A<- rnorm(n_test,0,1.5)

Y_A<- ((B_S_A)^2)*e_A

u_B<- rbeta(n_test,alpha,alpha)
z_B<- pnorm(u_B,0,1)
e_B<- exp(mu+z_B)
B_S_B<- rnorm(n_test,0.25,2)

Y_B<- ((B_S_B)^2)*e_B

u_C<- rbeta(n_test,alpha,alpha)
z_C<- pnorm(u_B,0,1)
e_C<- exp(mu+z_B)
B_S_C<- rnorm(n_test,0.5,2)

Y_C<- ((B_S_C)^2)*e_C

u_D<- rbeta(n_test,alpha,alpha)
z_D<- pnorm(u_B,0,1)
e_D<- exp(mu+z_B)
B_S_D<- rnorm(n_test,0.75,2)

Y_D<- ((B_S_D)^2)*e_D

u_E<- rbeta(n_test,alpha,alpha)
z_E<- pnorm(u_B,0,1)
e_E<- exp(mu+z_B)
B_S_E<- rnorm(n_test,1,2)

Y_E<- ((B_S_E)^2)*e_E
###########################

#ctrl probes
#90, uniform 1-20
n_ctrl_small<-48
n_ctrl_buffer<- 816
n_empty<- 3072

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_A<- c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)^2


H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_B<- ((c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)+0.25)*1.3)^2



H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_C<- ((c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)+0.5)*1.3)^2

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_D<- ((c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)+0.75)*1.3)^2

H1<- runif(n_ctrl_small,1.02,2.7)

H2_AB<- runif(n_ctrl_small,1.03,3.9)
H3<- runif(n_ctrl_small,2.64,4.9)
H4<- runif(n_ctrl_small,1.21,2.43)

Igg_488<- runif(n_ctrl_small,5.39,65.2)
Rhodamine<- runif(n_ctrl_small,1.12,113.7)
GST10<- runif(n_ctrl_small,1.02,1.2)

GST50<- runif(n_ctrl_small,1.09,1.24)
GST100<- runif(n_ctrl_small,1.17,1.41)
GST200<- runif(n_ctrl_small,1.26,1.67)

Mouse<- runif(n_ctrl_small,1.24,2.04)
Rabbit<- runif(n_ctrl_small,1.06,1.24)
Biotin_BSA<- runif(n_ctrl_small,1.02,1.34)

BSA<- runif(n_ctrl_small,1.32,5.66)
buffer<- runif(n_ctrl_buffer,0.25,2.03)
empty<- runif(n_empty,0.72,2.65)
Mouse_Igm<- runif(n_ctrl_small,1.55,3.63)

ctrl_E<- ((c(H1,H2_AB,H3,H4,Igg_488,Rhodamine,GST10,GST50,GST100,GST200,
           Mouse,Rabbit,Biotin_BSA,BSA,buffer,empty, Mouse_Igm)+1)*1.3)^2


###########################################


#spike in controls
#select 3 from each quartile 
q_1_A<- Y_A[which(Y_A<summary(Y_A)[2])]
spike_q1<- sample(q_1_A,size=3)


q_2_A<- Y_A[which(Y_A>summary(Y_A)[2]&Y_A<summary(Y_A)[3])]
spike_q2<- sample(q_2_A,size=3)

q_3_A<- Y_A[which(Y_A>summary(Y_A)[3]&Y_A<summary(Y_A)[5])]
spike_q3<- sample(q_3_A,size=3)

q_4_A<- Y_A[which(Y_A>summary(Y_A)[5])]
spike_q4<- sample(q_4_A,size=3)


#select replacements

#replacement index yb

index_q_1_B<- which(Y_B<summary(Y_B)[2])

spike_q1_B<- sample(c(index_q_1_B),size=3)

Y_B[spike_q1_B]<- spike_q1


index_q_2_B<- which(Y_B>summary(Y_B)[2]&Y_B<summary(Y_B)[3])

spike_q2_B<- sample(c(index_q_2_B),size=3)

Y_B[spike_q2_B]<- spike_q2



index_q_3_B<- which(Y_B>summary(Y_B)[3]&Y_B<summary(Y_B)[5])

spike_q3_B<- sample(c(index_q_3_B),size=3)

Y_B[spike_q3_B]<- spike_q3


index_q_4_B<- which(Y_B>summary(Y_B)[5])

spike_q4_B<- sample(c(index_q_4_B),size=3)

Y_B[spike_q4_B]<- spike_q4


index_q_1_C<- which(Y_C<summary(Y_C)[2])

spike_q1_C<- sample(c(index_q_1_C),size=3)

Y_C[spike_q1_C]<- spike_q1


index_q_2_C<- which(Y_C>summary(Y_C)[2]&Y_C<summary(Y_C)[3])

spike_q2_C<- sample(c(index_q_2_C),size=3)

Y_C[spike_q2_C]<- spike_q2



index_q_3_C<- which(Y_C>summary(Y_C)[3]&Y_C<summary(Y_C)[5])

spike_q3_C<- sample(c(index_q_3_C),size=3)

Y_C[spike_q3_C]<- spike_q3


index_q_4_C<- which(Y_C>summary(Y_C)[5])

spike_q4_C<- sample(c(index_q_4_C),size=3)

Y_C[spike_q4_C]<- spike_q4


index_q_1_D<- which(Y_D<summary(Y_D)[2])

spike_q1_D<- sample(c(index_q_1_D),size=3)

Y_D[spike_q1_D]<- spike_q1


index_q_2_D<- which(Y_D>summary(Y_D)[2]&Y_D<summary(Y_D)[3])

spike_q2_D<- sample(c(index_q_2_D),size=3)

Y_D[spike_q2_D]<- spike_q2



index_q_3_D<- which(Y_D>summary(Y_D)[3]&Y_D<summary(Y_D)[5])

spike_q3_D<- sample(c(index_q_3_D),size=3)

Y_D[spike_q3_D]<- spike_q3


index_q_4_D<- which(Y_D>summary(Y_D)[5])

spike_q4_D<- sample(c(index_q_4_D),size=3)

Y_D[spike_q4_D]<- spike_q4

index_q_1_E<- which(Y_E<summary(Y_E)[2])

spike_q1_E<- sample(c(index_q_1_E),size=3)

Y_E[spike_q1_E]<- spike_q1


index_q_2_E<- which(Y_E>summary(Y_E)[2]&Y_E<summary(Y_E)[3])

spike_q2_E<- sample(c(index_q_2_E),size=3)

Y_E[spike_q2_E]<- spike_q2



index_q_3_E<- which(Y_E>summary(Y_E)[3]&Y_E<summary(Y_E)[5])

spike_q3_E<- sample(c(index_q_3_E),size=3)

Y_E[spike_q3_E]<- spike_q3


index_q_4_E<- which(Y_E>summary(Y_E)[5])

spike_q4_E<- sample(c(index_q_4_E),size=3)

Y_E[spike_q4_E]<- spike_q4

################################################


log_Y_A<- log(c(Y_A,ctrl_A))

log_Y_B<- log(c(Y_B,ctrl_B))

log_Y_C<- log(c(Y_C,ctrl_C))

log_Y_D<- log(c(Y_D,ctrl_D))

log_Y_E<- log(c(Y_E,ctrl_E))

###############################################
#RLM MODEL

slide_matrix<- cbind(c(rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A))), c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A)),rep(0,length(ctrl_A))),c(rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(0,length(ctrl_A)),rep(1,length(ctrl_A))))

spot_matrix_A<- cbind(c(rep(0,n_ctrl_small),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*2))),
c(rep(0,(n_ctrl_small*2)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*3))),
c(rep(0,(n_ctrl_small*3)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*4))),
c(rep(0,(n_ctrl_small*4)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*5))),
c(rep(0,(n_ctrl_small*5)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*6))),
c(rep(0,(n_ctrl_small*6)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*7))),
c(rep(0,(n_ctrl_small*7)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*8))),
c(rep(0,(n_ctrl_small*8)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*9))),
c(rep(0,(n_ctrl_small*9)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*10))),
c(rep(0,(n_ctrl_small*10)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*11))),
c(rep(0,(n_ctrl_small*11)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*12))),
c(rep(0,(n_ctrl_small*12)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*13))),
c(rep(0,(n_ctrl_small*13)),rep(1,n_ctrl_small),rep(0,length(ctrl_A)-(n_ctrl_small*14))),
c(rep(0,n_ctrl_small*14),rep(1,n_ctrl_buffer),rep(0,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(1,n_empty),rep(0,n_ctrl_small)),
c(rep(0,n_ctrl_small*14),rep(0,n_ctrl_buffer),rep(0,n_empty),rep(1,n_ctrl_small)))

spot_matrix<- rbind(spot_matrix_A,spot_matrix_A,spot_matrix_A, spot_matrix_A, spot_matrix_A)


model_matrix<- cbind(c(ctrl_A,ctrl_B, ctrl_C, ctrl_D, ctrl_E),slide_matrix,spot_matrix)

model_A<- rlm(model_matrix[,1]~model_matrix[,2:21])


corrected_log_Y_A<- log_Y_A-model_A$coefficients[1]

corrected_log_Y_B<- log_Y_B-model_A$coefficients[1]-model_A$coefficients[2]
corrected_log_Y_C<- log_Y_C-model_A$coefficients[1]-model_A$coefficients[3]
corrected_log_Y_D<- log_Y_D-model_A$coefficients[1]-model_A$coefficients[4]
corrected_log_Y_E<- log_Y_E-model_A$coefficients[1]-model_A$coefficients[5]
###################################

#std

mean_A<- mean(corrected_log_Y_A[10001:14608])
sd_A<- sd(corrected_log_Y_A[10001:14608])

std_log_Y_A<- (corrected_log_Y_A-mean_A)/sd_A


mean_B<- mean(corrected_log_Y_B[10001:14608])
sd_B<- sd(corrected_log_Y_B[10001:14608])

std_log_Y_B<- (corrected_log_Y_B-mean_B)/sd_B


mean_C<- mean(corrected_log_Y_C[10001:14608])
sd_C<- sd(corrected_log_Y_C[10001:14608])

std_log_Y_C<- (corrected_log_Y_C-mean_C)/sd_C

mean_D<- mean(corrected_log_Y_D[10001:14608])
sd_D<- sd(corrected_log_Y_D[10001:14608])

std_log_Y_D<- (corrected_log_Y_D-mean_D)/sd_D

mean_E<- mean(corrected_log_Y_E[10001:14608])
sd_E<- sd(corrected_log_Y_E[10001:14608])

std_log_Y_E<- (corrected_log_Y_E-mean_E)/sd_E



################################
med_A<- median(corrected_log_Y_A[10001:14608])
IQR_A<- IQR(corrected_log_Y_A[10001:14608])/1.35

med_log_Y_A<- (corrected_log_Y_A-med_A)/IQR_A


med_B<- median(corrected_log_Y_B[10001:14608])
IQR_B<- IQR(corrected_log_Y_B[10001:14608])/1.35

med_log_Y_B<- (corrected_log_Y_B-med_B)/IQR_B


med_C<- median(corrected_log_Y_C[10001:14608])
IQR_C<- IQR(corrected_log_Y_C[10001:14608])/1.35

med_log_Y_C<- (corrected_log_Y_C-med_C)/IQR_C

med_D<- median(corrected_log_Y_D[10001:14608])
IQR_D<- IQR(corrected_log_Y_D[10001:14608])/1.35

med_log_Y_D<- (corrected_log_Y_D-med_D)/IQR_D

med_E<- median(corrected_log_Y_E[10001:14608])
IQR_E<- IQR(corrected_log_Y_E[10001:14608])/1.35

med_log_Y_E<- (corrected_log_Y_E-med_E)/IQR_E

##########################################

wins_mean_A<- mean(Winsorize(corrected_log_Y_A[10001:14608]))
wins_sd_A<- sd(Winsorize(corrected_log_Y_A[10001:14608]))

wins_log_Y_A<- (corrected_log_Y_A-wins_mean_A)/wins_sd_A


wins_mean_B<- mean(Winsorize(corrected_log_Y_B[10001:14608]))
wins_sd_B<- sd(Winsorize(corrected_log_Y_B[10001:14608]))

wins_log_Y_B<- (corrected_log_Y_B-wins_mean_B)/wins_sd_B


wins_mean_C<- mean(Winsorize(corrected_log_Y_C[10001:14608]))
wins_sd_C<- sd(Winsorize(corrected_log_Y_C[10001:14608]))

wins_log_Y_C<- (corrected_log_Y_C-wins_mean_C)/wins_sd_C

wins_mean_D<- mean(Winsorize(corrected_log_Y_D[10001:14608]))
wins_sd_D<- sd(Winsorize(corrected_log_Y_D[10001:14608]))

wins_log_Y_D<- (corrected_log_Y_D-wins_mean_D)/wins_sd_D

wins_mean_E<- mean(Winsorize(corrected_log_Y_E[10001:14608]))
wins_sd_E<- sd(Winsorize(corrected_log_Y_E[10001:14608]))

wins_log_Y_E<- (corrected_log_Y_E-wins_mean_E)/wins_sd_E

log_matrix<- cbind(log_Y_A,log_Y_B,log_Y_C,log_Y_D,log_Y_E)
quantile_matrix<- normalize.quantiles(log_matrix)
#
#vsn 

vsn_matrix<- normalizeVSN(log_matrix)

#cyclic_loess
cl_matrix<- normalizeCyclicLoess(log_matrix)

############################################################

between_df_A_B<- cbind((log_Y_A-log_Y_B),(log_Y_A+log_Y_B)/2)
between_df_A_C<- cbind((log_Y_A-log_Y_C),(log_Y_A+log_Y_C)/2)
between_df_A_D<- cbind((log_Y_A-log_Y_D),(log_Y_A+log_Y_D)/2)
between_df_A_E<- cbind((log_Y_A-log_Y_E),(log_Y_A+log_Y_E)/2)
between_df_B_C<- cbind((log_Y_B-log_Y_C),(log_Y_B+log_Y_C)/2)
between_df_B_D<- cbind((log_Y_B-log_Y_D),(log_Y_B+log_Y_D)/2)
between_df_B_E<- cbind((log_Y_B-log_Y_E),(log_Y_B+log_Y_E)/2)
between_df_C_D<- cbind((log_Y_C-log_Y_D),(log_Y_C+log_Y_D)/2)
between_df_C_E<- cbind((log_Y_C-log_Y_E),(log_Y_C+log_Y_E)/2)
between_df_D_E<- cbind((log_Y_D-log_Y_E),(log_Y_D+log_Y_E)/2)


#####################################################


corrected_between_df_A_B<- cbind((corrected_log_Y_A-corrected_log_Y_B),(corrected_log_Y_A+corrected_log_Y_B)/2)
corrected_between_df_A_C<- cbind((corrected_log_Y_A-corrected_log_Y_C),(corrected_log_Y_A+corrected_log_Y_C)/2)
corrected_between_df_A_D<- cbind((corrected_log_Y_A-corrected_log_Y_D),(corrected_log_Y_A+corrected_log_Y_D)/2)
corrected_between_df_A_E<- cbind((corrected_log_Y_A-corrected_log_Y_E),(corrected_log_Y_A+corrected_log_Y_E)/2)
corrected_between_df_B_C<- cbind((corrected_log_Y_B-corrected_log_Y_C),(corrected_log_Y_B+corrected_log_Y_C)/2)
corrected_between_df_B_D<- cbind((corrected_log_Y_B-corrected_log_Y_D),(corrected_log_Y_B+corrected_log_Y_D)/2)
corrected_between_df_B_E<- cbind((corrected_log_Y_B-corrected_log_Y_E),(corrected_log_Y_B+corrected_log_Y_E)/2)
corrected_between_df_C_D<- cbind((corrected_log_Y_C-corrected_log_Y_D),(corrected_log_Y_C+corrected_log_Y_D)/2)
corrected_between_df_C_E<- cbind((corrected_log_Y_C-corrected_log_Y_E),(corrected_log_Y_C+corrected_log_Y_E)/2)
corrected_between_df_D_E<- cbind((corrected_log_Y_D-corrected_log_Y_E),(corrected_log_Y_D+corrected_log_Y_E)/2)


#############################################################




std_between_df_A_B<- cbind((std_log_Y_A-std_log_Y_B),(std_log_Y_A+std_log_Y_B)/2)
std_between_df_A_C<- cbind((std_log_Y_A-std_log_Y_C),(std_log_Y_A+std_log_Y_C)/2)
std_between_df_A_D<- cbind((std_log_Y_A-std_log_Y_D),(std_log_Y_A+std_log_Y_D)/2)
std_between_df_A_E<- cbind((std_log_Y_A-std_log_Y_E),(std_log_Y_A+std_log_Y_E)/2)
std_between_df_B_C<- cbind((std_log_Y_B-std_log_Y_C),(std_log_Y_B+std_log_Y_C)/2)
std_between_df_B_D<- cbind((std_log_Y_B-std_log_Y_D),(std_log_Y_B+std_log_Y_D)/2)
std_between_df_B_E<- cbind((std_log_Y_B-std_log_Y_E),(std_log_Y_B+std_log_Y_E)/2)
std_between_df_C_D<- cbind((std_log_Y_C-std_log_Y_D),(std_log_Y_C+std_log_Y_D)/2)
std_between_df_C_E<- cbind((std_log_Y_C-std_log_Y_E),(std_log_Y_C+std_log_Y_E)/2)
std_between_df_D_E<- cbind((std_log_Y_D-std_log_Y_E),(std_log_Y_D+std_log_Y_E)/2)
############################################

med_between_df_A_B<- cbind((med_log_Y_A-med_log_Y_B),(med_log_Y_A+med_log_Y_B)/2)
med_between_df_A_C<- cbind((med_log_Y_A-med_log_Y_C),(med_log_Y_A+med_log_Y_C)/2)
med_between_df_A_D<- cbind((med_log_Y_A-med_log_Y_D),(med_log_Y_A+med_log_Y_D)/2)
med_between_df_A_E<- cbind((med_log_Y_A-med_log_Y_E),(med_log_Y_A+med_log_Y_E)/2)
med_between_df_B_C<- cbind((med_log_Y_B-med_log_Y_C),(med_log_Y_B+med_log_Y_C)/2)
med_between_df_B_D<- cbind((med_log_Y_B-med_log_Y_D),(med_log_Y_B+med_log_Y_D)/2)
med_between_df_B_E<- cbind((med_log_Y_B-med_log_Y_E),(med_log_Y_B+med_log_Y_E)/2)
med_between_df_C_D<- cbind((med_log_Y_C-med_log_Y_D),(med_log_Y_C+med_log_Y_D)/2)
med_between_df_C_E<- cbind((med_log_Y_C-med_log_Y_E),(med_log_Y_C+med_log_Y_E)/2)
med_between_df_D_E<- cbind((med_log_Y_D-med_log_Y_E),(med_log_Y_D+med_log_Y_E)/2)

wins_between_df_A_B<- cbind((wins_log_Y_A-wins_log_Y_B),(wins_log_Y_A+wins_log_Y_B)/2)
wins_between_df_A_C<- cbind((wins_log_Y_A-wins_log_Y_C),(wins_log_Y_A+wins_log_Y_C)/2)
wins_between_df_A_D<- cbind((wins_log_Y_A-wins_log_Y_D),(wins_log_Y_A+wins_log_Y_D)/2)
wins_between_df_A_E<- cbind((wins_log_Y_A-wins_log_Y_E),(wins_log_Y_A+wins_log_Y_E)/2)
wins_between_df_B_C<- cbind((wins_log_Y_B-wins_log_Y_C),(wins_log_Y_B+wins_log_Y_C)/2)
wins_between_df_B_D<- cbind((wins_log_Y_B-wins_log_Y_D),(wins_log_Y_B+wins_log_Y_D)/2)
wins_between_df_B_E<- cbind((wins_log_Y_B-wins_log_Y_E),(wins_log_Y_B+wins_log_Y_E)/2)
wins_between_df_C_D<- cbind((wins_log_Y_C-wins_log_Y_D),(wins_log_Y_C+wins_log_Y_D)/2)
wins_between_df_C_E<- cbind((wins_log_Y_C-wins_log_Y_E),(wins_log_Y_C+wins_log_Y_E)/2)
wins_between_df_D_E<- cbind((wins_log_Y_D-wins_log_Y_E),(wins_log_Y_D+wins_log_Y_E)/2)


#quant

quant_between_df_A_B<- cbind((quantile_matrix[,1]-quantile_matrix[,2]),(quantile_matrix[,1]+quantile_matrix[,2])/2)
quant_between_df_A_C<- cbind((quantile_matrix[,1]-quantile_matrix[,3]),(quantile_matrix[,1]+quantile_matrix[,3])/2)
quant_between_df_A_D<- cbind((quantile_matrix[,1]-quantile_matrix[,4]),(quantile_matrix[,1]+quantile_matrix[,4])/2)
quant_between_df_A_E<- cbind((quantile_matrix[,1]-quantile_matrix[,5]),(quantile_matrix[,1]+quantile_matrix[,5])/2)
quant_between_df_B_C<- cbind((quantile_matrix[,2]-quantile_matrix[,3]),(quantile_matrix[,2]+quantile_matrix[,3])/2)
quant_between_df_B_D<- cbind((quantile_matrix[,2]-quantile_matrix[,4]),(quantile_matrix[,2]+quantile_matrix[,4])/2)
quant_between_df_B_E<- cbind((quantile_matrix[,2]-quantile_matrix[,5]),(quantile_matrix[,2]+quantile_matrix[,5])/2)
quant_between_df_C_D<- cbind((quantile_matrix[,3]-quantile_matrix[,4]),(quantile_matrix[,3]+quantile_matrix[,4])/2)
quant_between_df_C_E<- cbind((quantile_matrix[,3]-quantile_matrix[,5]),(quantile_matrix[,3]+quantile_matrix[,5])/2)
quant_between_df_D_E<- cbind((quantile_matrix[,4]-quantile_matrix[,5]),(quantile_matrix[,4]+quantile_matrix[,5])/2)
#vsn
vsn_between_df_A_B<- cbind((vsn_matrix[,1]-vsn_matrix[,2]),(vsn_matrix[,1]+vsn_matrix[,2])/2)
vsn_between_df_A_C<- cbind((vsn_matrix[,1]-vsn_matrix[,3]),(vsn_matrix[,1]+vsn_matrix[,3])/2)
vsn_between_df_A_D<- cbind((vsn_matrix[,1]-vsn_matrix[,4]),(vsn_matrix[,1]+vsn_matrix[,4])/2)
vsn_between_df_A_E<- cbind((vsn_matrix[,1]-vsn_matrix[,5]),(vsn_matrix[,1]+vsn_matrix[,5])/2)
vsn_between_df_B_C<- cbind((vsn_matrix[,2]-vsn_matrix[,3]),(vsn_matrix[,2]+vsn_matrix[,3])/2)
vsn_between_df_B_D<- cbind((vsn_matrix[,2]-vsn_matrix[,4]),(vsn_matrix[,2]+vsn_matrix[,4])/2)
vsn_between_df_B_E<- cbind((vsn_matrix[,2]-vsn_matrix[,5]),(vsn_matrix[,2]+vsn_matrix[,5])/2)
vsn_between_df_C_D<- cbind((vsn_matrix[,3]-vsn_matrix[,4]),(vsn_matrix[,3]+vsn_matrix[,4])/2)
vsn_between_df_C_E<- cbind((vsn_matrix[,3]-vsn_matrix[,5]),(vsn_matrix[,3]+vsn_matrix[,5])/2)
vsn_between_df_D_E<- cbind((vsn_matrix[,4]-vsn_matrix[,5]),(vsn_matrix[,4]+vsn_matrix[,5])/2)

#cl
cl_between_df_A_B<- cbind((cl_matrix[,1]-cl_matrix[,2]),(cl_matrix[,1]+cl_matrix[,2])/2)
cl_between_df_A_C<- cbind((cl_matrix[,1]-cl_matrix[,3]),(cl_matrix[,1]+cl_matrix[,3])/2)
cl_between_df_A_D<- cbind((cl_matrix[,1]-cl_matrix[,4]),(cl_matrix[,1]+cl_matrix[,4])/2)
cl_between_df_A_E<- cbind((cl_matrix[,1]-cl_matrix[,5]),(cl_matrix[,1]+cl_matrix[,5])/2)
cl_between_df_B_C<- cbind((cl_matrix[,2]-cl_matrix[,3]),(cl_matrix[,2]+cl_matrix[,3])/2)
cl_between_df_B_D<- cbind((cl_matrix[,2]-cl_matrix[,4]),(cl_matrix[,2]+cl_matrix[,4])/2)
cl_between_df_B_E<- cbind((cl_matrix[,2]-cl_matrix[,5]),(cl_matrix[,2]+cl_matrix[,5])/2)
cl_between_df_C_D<- cbind((cl_matrix[,3]-cl_matrix[,4]),(cl_matrix[,3]+cl_matrix[,4])/2)
cl_between_df_C_E<- cbind((cl_matrix[,3]-cl_matrix[,5]),(cl_matrix[,3]+cl_matrix[,5])/2)
cl_between_df_D_E<- cbind((cl_matrix[,4]-cl_matrix[,5]),(cl_matrix[,4]+cl_matrix[,5])/2)


########################################################


index_q1<- c(which(Y_A==spike_q1[1]),which(Y_A==spike_q1[2]),
              which(Y_A==spike_q1[3]))

index_q2<- c(which(Y_A==spike_q2[1]),which(Y_A==spike_q2[2]),
              which(Y_A==spike_q2[3]))

index_q3<- c(which(Y_A==spike_q3[1]),which(Y_A==spike_q3[2]),
              which(Y_A==spike_q3[3]))

index_q4<- c(which(Y_A==spike_q4[1]),which(Y_A==spike_q4[2]),
              which(Y_A==spike_q4[3]))



index_q1_B<- c(which(Y_B==spike_q1[1]),which(Y_B==spike_q1[2]),
              which(Y_B==spike_q1[3]))

index_q2_B<- c(which(Y_B==spike_q2[1]),which(Y_B==spike_q2[2]),
              which(Y_B==spike_q2[3]))

index_q3_B<- c(which(Y_B==spike_q3[1]),which(Y_B==spike_q3[2]),
              which(Y_B==spike_q3[3]))

index_q4_B<- c(which(Y_B==spike_q4[1]),which(Y_B==spike_q4[2]),
              which(Y_B==spike_q4[3]))

index_q1_C<- c(which(Y_C==spike_q1[1]),which(Y_C==spike_q1[2]),
              which(Y_C==spike_q1[3]))

index_q2_C<- c(which(Y_C==spike_q2[1]),which(Y_C==spike_q2[2]),
              which(Y_C==spike_q2[3]))

index_q3_C<- c(which(Y_C==spike_q3[1]),which(Y_C==spike_q3[2]),
              which(Y_C==spike_q3[3]))

index_q4_C<- c(which(Y_C==spike_q4[1]),which(Y_C==spike_q4[2]),
              which(Y_C==spike_q4[3]))

index_q1_D<- c(which(Y_D==spike_q1[1]),which(Y_D==spike_q1[2]),
              which(Y_D==spike_q1[3]))

index_q2_D<- c(which(Y_D==spike_q2[1]),which(Y_D==spike_q2[2]),
              which(Y_D==spike_q2[3]))

index_q3_D<- c(which(Y_D==spike_q3[1]),which(Y_D==spike_q3[2]),
              which(Y_D==spike_q3[3]))

index_q4_D<- c(which(Y_D==spike_q4[1]),which(Y_D==spike_q4[2]),
              which(Y_D==spike_q4[3]))

index_q1_E<- c(which(Y_E==spike_q1[1]),which(Y_E==spike_q1[2]),
              which(Y_E==spike_q1[3]))

index_q2_E<- c(which(Y_E==spike_q2[1]),which(Y_E==spike_q2[2]),
              which(Y_E==spike_q2[3]))

index_q3_E<- c(which(Y_E==spike_q3[1]),which(Y_E==spike_q3[2]),
              which(Y_E==spike_q3[3]))

index_q4_E<- c(which(Y_E==spike_q4[1]),which(Y_E==spike_q4[2]),
              which(Y_E==spike_q4[3]))




dif_mean_rlm_hp_mis_dif[r]<-mean(mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(corrected_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(corrected_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-corrected_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)

dif_mean_std_hp_mis_dif[r]<-mean(mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(std_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(std_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-std_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_med_hp_mis_dif[r]<-mean(mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(med_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(med_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-med_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)


dif_mean_wins_hp_mis_dif[r]<-mean(mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_A[c(index_q1,index_q2,index_q3,index_q4)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_B[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]),mean(wins_log_Y_C[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)]),mean(wins_log_Y_D[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D)]-wins_log_Y_E[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E)])
)




dif_mean_quant_hp_mis_dif[r]<-mean(mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(quantile_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(quantile_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-quantile_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)


dif_mean_vsn_hp_mis_dif[r]<-mean(mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(vsn_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(vsn_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-vsn_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5])
)



dif_mean_cl_hp_mis_dif[r]<-mean(mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1,index_q2,index_q3,index_q4),1]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_B,index_q2_B,index_q3_B,index_q4_B),2]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]),mean(cl_matrix[c(index_q1_C,index_q2_C,index_q3_C,index_q4_C),3]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]),mean(cl_matrix[c(index_q1_D,index_q2_D,index_q3_D,index_q4_D),4]-cl_matrix[c(index_q1_E,index_q2_E,index_q3_E,index_q4_E),5]))

################################


cv_rlm_AB<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_B)))
cv_rlm_AC<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_C)))
cv_rlm_AD<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_D)))
cv_rlm_AE<- cv(x=c(sort(corrected_log_Y_A)-sort(corrected_log_Y_E)))
cv_rlm_BC<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_C)))
cv_rlm_BD<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_D)))
cv_rlm_BE<- cv(x=c(sort(corrected_log_Y_B)-sort(corrected_log_Y_E)))
cv_rlm_CD<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_D)))
cv_rlm_CE<- cv(x=c(sort(corrected_log_Y_C)-sort(corrected_log_Y_E)))
cv_rlm_DE<- cv(x=c(sort(corrected_log_Y_D)-sort(corrected_log_Y_E)))

cv_rlm_hp_mis_dif[r]<- mean(cv_rlm_AB,cv_rlm_AC,cv_rlm_AD,cv_rlm_AE,
                 cv_rlm_BC,cv_rlm_BD,cv_rlm_BE,
                 cv_rlm_CD,cv_rlm_CE,
                 cv_rlm_DE)


cv_std_AB<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_B)))
cv_std_AC<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_C)))
cv_std_AD<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_D)))
cv_std_AE<- cv(x=c(sort(std_log_Y_A)-sort(std_log_Y_E)))
cv_std_BC<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_C)))
cv_std_BD<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_D)))
cv_std_BE<- cv(x=c(sort(std_log_Y_B)-sort(std_log_Y_E)))
cv_std_CD<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_D)))
cv_std_CE<- cv(x=c(sort(std_log_Y_C)-sort(std_log_Y_E)))
cv_std_DE<- cv(x=c(sort(std_log_Y_D)-sort(std_log_Y_E)))

cv_std_hp_mis_dif[r]<- mean(cv_std_AB,cv_std_AC,cv_std_AD,cv_std_AE,
                 cv_std_BC,cv_std_BD,cv_std_BE,
                 cv_std_CD,cv_std_CE,
                 cv_std_DE)

cv_med_AB<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_B)))
cv_med_AC<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_C)))
cv_med_AD<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_D)))
cv_med_AE<- cv(x=c(sort(med_log_Y_A)-sort(med_log_Y_E)))
cv_med_BC<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_C)))
cv_med_BD<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_D)))
cv_med_BE<- cv(x=c(sort(med_log_Y_B)-sort(med_log_Y_E)))
cv_med_CD<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_D)))
cv_med_CE<- cv(x=c(sort(med_log_Y_C)-sort(med_log_Y_E)))
cv_med_DE<- cv(x=c(sort(med_log_Y_D)-sort(med_log_Y_E)))

cv_med_hp_mis_dif[r]<- mean(cv_med_AB,cv_med_AC,cv_med_AD,cv_med_AE,
                 cv_med_BC,cv_med_BD,cv_med_BE,
                 cv_med_CD,cv_med_CE,
                 cv_med_DE)

cv_wins_AB<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_B)))
cv_wins_AC<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_C)))
cv_wins_AD<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_D)))
cv_wins_AE<- cv(x=c(sort(wins_log_Y_A)-sort(wins_log_Y_E)))
cv_wins_BC<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_C)))
cv_wins_BD<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_D)))
cv_wins_BE<- cv(x=c(sort(wins_log_Y_B)-sort(wins_log_Y_E)))
cv_wins_CD<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_D)))
cv_wins_CE<- cv(x=c(sort(wins_log_Y_C)-sort(wins_log_Y_E)))
cv_wins_DE<- cv(x=c(sort(wins_log_Y_D)-sort(wins_log_Y_E)))

cv_wins_hp_mis_dif[r]<- mean(cv_wins_AB,cv_wins_AC,cv_wins_AD,cv_wins_AE,
                 cv_wins_BC,cv_wins_BD,cv_wins_BE,
                 cv_wins_CD,cv_wins_CE,
                 cv_wins_DE)


cv_vsn_AB<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,2])))
cv_vsn_AC<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,3])))
cv_vsn_AD<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,4])))
cv_vsn_AE<- cv(x=c(sort(vsn_matrix[,1])-sort(vsn_matrix[,5])))
cv_vsn_BC<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,3])))
cv_vsn_BD<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,4])))
cv_vsn_BE<- cv(x=c(sort(vsn_matrix[,2])-sort(vsn_matrix[,5])))
cv_vsn_CD<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,4])))
cv_vsn_CE<- cv(x=c(sort(vsn_matrix[,3])-sort(vsn_matrix[,5])))
cv_vsn_DE<- cv(x=c(sort(vsn_matrix[,4])-sort(vsn_matrix[,5])))


cv_vsn_hp_mis_dif[r]<- mean(cv_vsn_AB,cv_vsn_AC,cv_vsn_AD,cv_vsn_AE,
                 cv_vsn_BC,cv_vsn_BD,cv_vsn_BE,
                 cv_vsn_CD,cv_vsn_CE,
                 cv_vsn_DE)



cv_cl_AB<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,2])))
cv_cl_AC<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,3])))
cv_cl_AD<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,4])))
cv_cl_AE<- cv(x=c(sort(cl_matrix[,1])-sort(cl_matrix[,5])))
cv_cl_BC<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,3])))
cv_cl_BD<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,4])))
cv_cl_BE<- cv(x=c(sort(cl_matrix[,2])-sort(cl_matrix[,5])))
cv_cl_CD<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,4])))
cv_cl_CE<- cv(x=c(sort(cl_matrix[,3])-sort(cl_matrix[,5])))
cv_cl_DE<- cv(x=c(sort(cl_matrix[,4])-sort(cl_matrix[,5])))


cv_cl_hp_mis_dif[r]<- mean(cv_cl_AB,cv_cl_AC,cv_cl_AD,cv_cl_AE,
                 cv_cl_BC,cv_cl_BD,cv_cl_BE,
                 cv_cl_CD,cv_cl_CE,
                 cv_cl_DE)




dif_mean_rlm_AB<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_B))^2
dif_mean_rlm_AC<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_C))^2
dif_mean_rlm_AD<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_D))^2
dif_mean_rlm_AE<-(mean(corrected_log_Y_A)-mean(corrected_log_Y_E))^2
dif_mean_rlm_BC<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_C))^2
dif_mean_rlm_BD<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_D))^2
dif_mean_rlm_BE<-(mean(corrected_log_Y_B)-mean(corrected_log_Y_E))^2
dif_mean_rlm_CD<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_D))^2
dif_mean_rlm_CE<-(mean(corrected_log_Y_C)-mean(corrected_log_Y_E))^2
dif_mean_rlm_DE<-(mean(corrected_log_Y_D)-mean(corrected_log_Y_E))^2

mse_rlm_mean_hp_mis_dif[r]<- sum(dif_mean_rlm_AB,dif_mean_rlm_AC,dif_mean_rlm_AD,dif_mean_rlm_AE,
                      dif_mean_rlm_BC,dif_mean_rlm_BD,dif_mean_rlm_BE,
                      dif_mean_rlm_CD,dif_mean_rlm_CE,
                      dif_mean_rlm_DE)

dif_var_rlm_AB<-(var(corrected_log_Y_A)-var(corrected_log_Y_B))^2
dif_var_rlm_AC<-(var(corrected_log_Y_A)-var(corrected_log_Y_C))^2
dif_var_rlm_AD<-(var(corrected_log_Y_A)-var(corrected_log_Y_D))^2
dif_var_rlm_AE<-(var(corrected_log_Y_A)-var(corrected_log_Y_E))^2
dif_var_rlm_BC<-(var(corrected_log_Y_B)-var(corrected_log_Y_C))^2
dif_var_rlm_BD<-(var(corrected_log_Y_B)-var(corrected_log_Y_D))^2
dif_var_rlm_BE<-(var(corrected_log_Y_B)-var(corrected_log_Y_E))^2
dif_var_rlm_CD<-(var(corrected_log_Y_C)-var(corrected_log_Y_D))^2
dif_var_rlm_CE<-(var(corrected_log_Y_C)-var(corrected_log_Y_E))^2
dif_var_rlm_DE<-(var(corrected_log_Y_D)-var(corrected_log_Y_E))^2

mse_rlm_var_hp_mis_dif[r]<- sum(dif_var_rlm_AB,dif_var_rlm_AC,dif_var_rlm_AD,dif_var_rlm_AE,
                      dif_var_rlm_BC,dif_var_rlm_BD,dif_var_rlm_BE,
                      dif_var_rlm_CD,dif_var_rlm_CE,
                      dif_var_rlm_DE)



dif_mean_std_AB<-(mean(std_log_Y_A)-mean(std_log_Y_B))^2
dif_mean_std_AC<-(mean(std_log_Y_A)-mean(std_log_Y_C))^2
dif_mean_std_AD<-(mean(std_log_Y_A)-mean(std_log_Y_D))^2
dif_mean_std_AE<-(mean(std_log_Y_A)-mean(std_log_Y_E))^2
dif_mean_std_BC<-(mean(std_log_Y_B)-mean(std_log_Y_C))^2
dif_mean_std_BD<-(mean(std_log_Y_B)-mean(std_log_Y_D))^2
dif_mean_std_BE<-(mean(std_log_Y_B)-mean(std_log_Y_E))^2
dif_mean_std_CD<-(mean(std_log_Y_C)-mean(std_log_Y_D))^2
dif_mean_std_CE<-(mean(std_log_Y_C)-mean(std_log_Y_E))^2
dif_mean_std_DE<-(mean(std_log_Y_D)-mean(std_log_Y_E))^2

mse_std_mean_hp_mis_dif[r]<- sum(dif_mean_std_AB,dif_mean_std_AC,dif_mean_std_AD,dif_mean_std_AE,
                      dif_mean_std_BC,dif_mean_std_BD,dif_mean_std_BE,
                      dif_mean_std_CD,dif_mean_std_CE,
                      dif_mean_std_DE)

dif_var_std_AB<-(var(std_log_Y_A)-var(std_log_Y_B))^2
dif_var_std_AC<-(var(std_log_Y_A)-var(std_log_Y_C))^2
dif_var_std_AD<-(var(std_log_Y_A)-var(std_log_Y_D))^2
dif_var_std_AE<-(var(std_log_Y_A)-var(std_log_Y_E))^2
dif_var_std_BC<-(var(std_log_Y_B)-var(std_log_Y_C))^2
dif_var_std_BD<-(var(std_log_Y_B)-var(std_log_Y_D))^2
dif_var_std_BE<-(var(std_log_Y_B)-var(std_log_Y_E))^2
dif_var_std_CD<-(var(std_log_Y_C)-var(std_log_Y_D))^2
dif_var_std_CE<-(var(std_log_Y_C)-var(std_log_Y_E))^2
dif_var_std_DE<-(var(std_log_Y_D)-var(std_log_Y_E))^2

mse_std_var_hp_mis_dif[r]<- sum(dif_var_std_AB,dif_var_std_AC,dif_var_std_AD,dif_var_std_AE,
                      dif_var_std_BC,dif_var_std_BD,dif_var_std_BE,
                      dif_var_std_CD,dif_var_std_CE,
                      dif_var_std_DE)



dif_mean_med_AB<-(mean(med_log_Y_A)-mean(med_log_Y_B))^2
dif_mean_med_AC<-(mean(med_log_Y_A)-mean(med_log_Y_C))^2
dif_mean_med_AD<-(mean(med_log_Y_A)-mean(med_log_Y_D))^2
dif_mean_med_AE<-(mean(med_log_Y_A)-mean(med_log_Y_E))^2
dif_mean_med_BC<-(mean(med_log_Y_B)-mean(med_log_Y_C))^2
dif_mean_med_BD<-(mean(med_log_Y_B)-mean(med_log_Y_D))^2
dif_mean_med_BE<-(mean(med_log_Y_B)-mean(med_log_Y_E))^2
dif_mean_med_CD<-(mean(med_log_Y_C)-mean(med_log_Y_D))^2
dif_mean_med_CE<-(mean(med_log_Y_C)-mean(med_log_Y_E))^2
dif_mean_med_DE<-(mean(med_log_Y_D)-mean(med_log_Y_E))^2

mse_med_mean_hp_mis_dif[r]<- sum(dif_mean_med_AB,dif_mean_med_AC,dif_mean_med_AD,dif_mean_med_AE,
                      dif_mean_med_BC,dif_mean_med_BD,dif_mean_med_BE,
                      dif_mean_med_CD,dif_mean_med_CE,
                      dif_mean_med_DE)

dif_var_med_AB<-(var(med_log_Y_A)-var(med_log_Y_B))^2
dif_var_med_AC<-(var(med_log_Y_A)-var(med_log_Y_C))^2
dif_var_med_AD<-(var(med_log_Y_A)-var(med_log_Y_D))^2
dif_var_med_AE<-(var(med_log_Y_A)-var(med_log_Y_E))^2
dif_var_med_BC<-(var(med_log_Y_B)-var(med_log_Y_C))^2
dif_var_med_BD<-(var(med_log_Y_B)-var(med_log_Y_D))^2
dif_var_med_BE<-(var(med_log_Y_B)-var(med_log_Y_E))^2
dif_var_med_CD<-(var(med_log_Y_C)-var(med_log_Y_D))^2
dif_var_med_CE<-(var(med_log_Y_C)-var(med_log_Y_E))^2
dif_var_med_DE<-(var(med_log_Y_D)-var(med_log_Y_E))^2

mse_med_var_hp_mis_dif[r]<- sum(dif_var_med_AB,dif_var_med_AC,dif_var_med_AD,dif_var_med_AE,
                      dif_var_med_BC,dif_var_med_BD,dif_var_med_BE,
                      dif_var_med_CD,dif_var_med_CE,
                      dif_var_med_DE)



dif_mean_wins_AB<-(mean(wins_log_Y_A)-mean(wins_log_Y_B))^2
dif_mean_wins_AC<-(mean(wins_log_Y_A)-mean(wins_log_Y_C))^2
dif_mean_wins_AD<-(mean(wins_log_Y_A)-mean(wins_log_Y_D))^2
dif_mean_wins_AE<-(mean(wins_log_Y_A)-mean(wins_log_Y_E))^2
dif_mean_wins_BC<-(mean(wins_log_Y_B)-mean(wins_log_Y_C))^2
dif_mean_wins_BD<-(mean(wins_log_Y_B)-mean(wins_log_Y_D))^2
dif_mean_wins_BE<-(mean(wins_log_Y_B)-mean(wins_log_Y_E))^2
dif_mean_wins_CD<-(mean(wins_log_Y_C)-mean(wins_log_Y_D))^2
dif_mean_wins_CE<-(mean(wins_log_Y_C)-mean(wins_log_Y_E))^2
dif_mean_wins_DE<-(mean(wins_log_Y_D)-mean(wins_log_Y_E))^2

mse_wins_mean_hp_mis_dif[r]<- sum(dif_mean_wins_AB,dif_mean_wins_AC,dif_mean_wins_AD,dif_mean_wins_AE,
                      dif_mean_wins_BC,dif_mean_wins_BD,dif_mean_wins_BE,
                      dif_mean_wins_CD,dif_mean_wins_CE,
                      dif_mean_wins_DE)

dif_var_wins_AB<-(var(wins_log_Y_A)-var(wins_log_Y_B))^2
dif_var_wins_AC<-(var(wins_log_Y_A)-var(wins_log_Y_C))^2
dif_var_wins_AD<-(var(wins_log_Y_A)-var(wins_log_Y_D))^2
dif_var_wins_AE<-(var(wins_log_Y_A)-var(wins_log_Y_E))^2
dif_var_wins_BC<-(var(wins_log_Y_B)-var(wins_log_Y_C))^2
dif_var_wins_BD<-(var(wins_log_Y_B)-var(wins_log_Y_D))^2
dif_var_wins_BE<-(var(wins_log_Y_B)-var(wins_log_Y_E))^2
dif_var_wins_CD<-(var(wins_log_Y_C)-var(wins_log_Y_D))^2
dif_var_wins_CE<-(var(wins_log_Y_C)-var(wins_log_Y_E))^2
dif_var_wins_DE<-(var(wins_log_Y_D)-var(wins_log_Y_E))^2

mse_wins_var_hp_mis_dif[r]<- sum(dif_var_wins_AB,dif_var_wins_AC,dif_var_wins_AD,dif_var_wins_AE,
                      dif_var_wins_BC,dif_var_wins_BD,dif_var_wins_BE,
                      dif_var_wins_CD,dif_var_wins_CE,
                      dif_var_wins_DE)



dif_mean_quant_AB<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,2]))^2
dif_mean_quant_AC<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,3]))^2
dif_mean_quant_AD<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,4]))^2
dif_mean_quant_AE<-(mean(quantile_matrix[,1])-mean(quantile_matrix[,5]))^2
dif_mean_quant_BC<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,3]))^2
dif_mean_quant_BD<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,4]))^2
dif_mean_quant_BE<-(mean(quantile_matrix[,2])-mean(quantile_matrix[,5]))^2
dif_mean_quant_CD<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,4]))^2
dif_mean_quant_CE<-(mean(quantile_matrix[,3])-mean(quantile_matrix[,5]))^2
dif_mean_quant_DE<-(mean(quantile_matrix[,4])-mean(quantile_matrix[,5]))^2

mse_quant_mean_hp_mis_dif[r]<- sum(dif_mean_quant_AB,dif_mean_quant_AC,dif_mean_quant_AD,dif_mean_quant_AE,
                      dif_mean_quant_BC,dif_mean_quant_BD,dif_mean_quant_BE,
                      dif_mean_quant_CD,dif_mean_quant_CE,
                      dif_mean_quant_DE)

dif_var_quant_AB<-(var(quantile_matrix[,1])-var(quantile_matrix[,2]))^2
dif_var_quant_AC<-(var(quantile_matrix[,1])-var(quantile_matrix[,3]))^2
dif_var_quant_AD<-(var(quantile_matrix[,1])-var(quantile_matrix[,4]))^2
dif_var_quant_AE<-(var(quantile_matrix[,1])-var(quantile_matrix[,5]))^2
dif_var_quant_BC<-(var(quantile_matrix[,2])-var(quantile_matrix[,3]))^2
dif_var_quant_BD<-(var(quantile_matrix[,2])-var(quantile_matrix[,4]))^2
dif_var_quant_BE<-(var(quantile_matrix[,2])-var(quantile_matrix[,5]))^2
dif_var_quant_CD<-(var(quantile_matrix[,3])-var(quantile_matrix[,4]))^2
dif_var_quant_CE<-(var(quantile_matrix[,3])-var(quantile_matrix[,5]))^2
dif_var_quant_DE<-(var(quantile_matrix[,4])-var(quantile_matrix[,5]))^2

mse_quant_var_hp_mis_dif[r]<- sum(dif_var_quant_AB,dif_var_quant_AC,dif_var_quant_AD,dif_var_quant_AE,
                      dif_var_quant_BC,dif_var_quant_BD,dif_var_quant_BE,
                      dif_var_quant_CD,dif_var_quant_CE,
                      dif_var_quant_DE)


dif_mean_vsn_AB<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,2]))^2
dif_mean_vsn_AC<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_AD<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_AE<-(mean(vsn_matrix[,1])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_BC<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,3]))^2
dif_mean_vsn_BD<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_BE<-(mean(vsn_matrix[,2])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_CD<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,4]))^2
dif_mean_vsn_CE<-(mean(vsn_matrix[,3])-mean(vsn_matrix[,5]))^2
dif_mean_vsn_DE<-(mean(vsn_matrix[,4])-mean(vsn_matrix[,5]))^2

mse_vsn_mean_hp_mis_dif[r]<- sum(dif_mean_vsn_AB,dif_mean_vsn_AC,dif_mean_vsn_AD,dif_mean_vsn_AE,
                      dif_mean_vsn_BC,dif_mean_vsn_BD,dif_mean_vsn_BE,
                      dif_mean_vsn_CD,dif_mean_vsn_CE,
                      dif_mean_vsn_DE)

dif_var_vsn_AB<-(var(vsn_matrix[,1])-var(vsn_matrix[,2]))^2
dif_var_vsn_AC<-(var(vsn_matrix[,1])-var(vsn_matrix[,3]))^2
dif_var_vsn_AD<-(var(vsn_matrix[,1])-var(vsn_matrix[,4]))^2
dif_var_vsn_AE<-(var(vsn_matrix[,1])-var(vsn_matrix[,5]))^2
dif_var_vsn_BC<-(var(vsn_matrix[,2])-var(vsn_matrix[,3]))^2
dif_var_vsn_BD<-(var(vsn_matrix[,2])-var(vsn_matrix[,4]))^2
dif_var_vsn_BE<-(var(vsn_matrix[,2])-var(vsn_matrix[,5]))^2
dif_var_vsn_CD<-(var(vsn_matrix[,3])-var(vsn_matrix[,4]))^2
dif_var_vsn_CE<-(var(vsn_matrix[,3])-var(vsn_matrix[,5]))^2
dif_var_vsn_DE<-(var(vsn_matrix[,4])-var(vsn_matrix[,5]))^2

mse_vsn_var_hp_mis_dif[r]<- sum(dif_var_vsn_AB,dif_var_vsn_AC,dif_var_vsn_AD,dif_var_vsn_AE,
                      dif_var_vsn_BC,dif_var_vsn_BD,dif_var_vsn_BE,
                      dif_var_vsn_CD,dif_var_vsn_CE,
                      dif_var_vsn_DE)



dif_mean_cl_AB<-(mean(cl_matrix[,1])-mean(cl_matrix[,2]))^2
dif_mean_cl_AC<-(mean(cl_matrix[,1])-mean(cl_matrix[,3]))^2
dif_mean_cl_AD<-(mean(cl_matrix[,1])-mean(cl_matrix[,4]))^2
dif_mean_cl_AE<-(mean(cl_matrix[,1])-mean(cl_matrix[,5]))^2
dif_mean_cl_BC<-(mean(cl_matrix[,2])-mean(cl_matrix[,3]))^2
dif_mean_cl_BD<-(mean(cl_matrix[,2])-mean(cl_matrix[,4]))^2
dif_mean_cl_BE<-(mean(cl_matrix[,2])-mean(cl_matrix[,5]))^2
dif_mean_cl_CD<-(mean(cl_matrix[,3])-mean(cl_matrix[,4]))^2
dif_mean_cl_CE<-(mean(cl_matrix[,3])-mean(cl_matrix[,5]))^2
dif_mean_cl_DE<-(mean(cl_matrix[,4])-mean(cl_matrix[,5]))^2

mse_cl_mean_hp_mis_dif[r]<- sum(dif_mean_cl_AB,dif_mean_cl_AC,dif_mean_cl_AD,dif_mean_cl_AE,
                      dif_mean_cl_BC,dif_mean_cl_BD,dif_mean_cl_BE,
                      dif_mean_cl_CD,dif_mean_cl_CE,
                      dif_mean_cl_DE)

dif_var_cl_AB<-(var(cl_matrix[,1])-var(cl_matrix[,2]))^2
dif_var_cl_AC<-(var(cl_matrix[,1])-var(cl_matrix[,3]))^2
dif_var_cl_AD<-(var(cl_matrix[,1])-var(cl_matrix[,4]))^2
dif_var_cl_AE<-(var(cl_matrix[,1])-var(cl_matrix[,5]))^2
dif_var_cl_BC<-(var(cl_matrix[,2])-var(cl_matrix[,3]))^2
dif_var_cl_BD<-(var(cl_matrix[,2])-var(cl_matrix[,4]))^2
dif_var_cl_BE<-(var(cl_matrix[,2])-var(cl_matrix[,5]))^2
dif_var_cl_CD<-(var(cl_matrix[,3])-var(cl_matrix[,4]))^2
dif_var_cl_CE<-(var(cl_matrix[,3])-var(cl_matrix[,5]))^2
dif_var_cl_DE<-(var(cl_matrix[,4])-var(cl_matrix[,5]))^2

mse_cl_var_hp_mis_dif[r]<- sum(dif_var_cl_AB,dif_var_cl_AC,dif_var_cl_AD,dif_var_cl_AE,
                      dif_var_cl_BC,dif_var_cl_BD,dif_var_cl_BE,
                      dif_var_cl_CD,dif_var_cl_CE,
                      dif_var_cl_DE)

}

```



```{r cache=T, message=F, warning=F, echo=F}


table_malaria<- as.data.frame(rbind(c(mean(dif_mean_quant),mean(dif_mean_vsn),
                              mean(dif_mean_cl),mean(dif_mean_quant_dif),
                              mean(dif_mean_vsn_dif),mean(dif_mean_cl_dif),
                              mean(dif_mean_quant_misspecified),
                              mean(dif_mean_vsn_misspecified),
                              mean(dif_mean_cl_misspecified),
                              mean(dif_mean_quant_misspecified_dif),
                              mean(dif_mean_vsn_misspecified_dif),
                              mean(dif_mean_cl_misspecified_dif)),
                            c(var(dif_mean_quant),var(dif_mean_vsn),
                              var(dif_mean_cl),var(dif_mean_quant_dif),
                              var(dif_mean_vsn_dif),var(dif_mean_cl_dif),
                              var(dif_mean_quant_misspecified),
                              var(dif_mean_vsn_misspecified),
                              var(dif_mean_cl_misspecified),
                              var(dif_mean_quant_misspecified_dif),
                              var(dif_mean_vsn_misspecified_dif),
                              var(dif_mean_cl_misspecified_dif)),
                            c(mean(mse_quant_mean),mean(mse_vsn_mean),
                              mean(mse_cl_mean),mean(mse_quant_mean_dif),
                              mean(mse_vsn_mean_dif),mean(mse_cl_mean_dif),
                              mean(mse_quant_mean_mis),mean(mse_vsn_mean_mis),
                              mean(mse_cl_mean_mis),
                              mean(mse_quant_mean_mis_dif),
                              mean(mse_vsn_mean_mis_dif),
                              mean(mse_cl_mean_mis_dif)),
                            c(var(mse_quant_mean),var(mse_vsn_mean),
                              var(mse_cl_mean),var(mse_quant_mean_dif),
                              var(mse_vsn_mean_dif),var(mse_cl_mean_dif),
                              var(mse_quant_mean_mis),var(mse_vsn_mean_mis),
                              var(mse_cl_mean_mis),
                              var(mse_quant_mean_mis_dif),
                              var(mse_vsn_mean_mis_dif),
                              var(mse_cl_mean_mis_dif)),
                            c(mean(mse_quant_var),mean(mse_vsn_var),
                              mean(mse_cl_var),mean(mse_quant_var_dif),
                              mean(mse_vsn_var_dif),mean(mse_cl_var_dif),
                              mean(mse_quant_var_mis),mean(mse_vsn_var_mis),
                              mean(mse_cl_var_mis),mean(mse_quant_var_mis_dif),
                              mean(mse_vsn_var_mis_dif),
                              mean(mse_cl_var_mis_dif)),
                            c(var(mse_quant_var),var(mse_vsn_var),
                              var(mse_cl_var),var(mse_quant_var_dif),
                              var(mse_vsn_var_dif),var(mse_cl_var_dif),
                              var(mse_quant_var_mis),var(mse_vsn_var_mis),
                              var(mse_cl_var_mis),var(mse_quant_var_mis_dif),
                              var(mse_vsn_var_mis_dif),
                              var(mse_cl_var_mis_dif))))


write.csv(table_malaria, "sim_BA_results_malaria.csv")


table_hp<- as.data.frame(rbind(c(mean(dif_mean_quant_hp),mean(dif_mean_vsn_hp),
                              mean(dif_mean_cl_hp),mean(dif_mean_quant_hp_dif),
                              mean(dif_mean_vsn_hp_dif),mean(dif_mean_cl_hp_dif),
                              mean(dif_mean_quant_hp_mis),
                              mean(dif_mean_vsn_hp_mis),
                              mean(dif_mean_cl_hp_mis),
                              mean(dif_mean_quant_hp_mis_dif),
                              mean(dif_mean_vsn_hp_mis_dif),
                              mean(dif_mean_cl_hp_mis_dif)),
                            c(var(dif_mean_quant_hp),var(dif_mean_vsn_hp),
                              var(dif_mean_cl_hp),var(dif_mean_quant_hp_dif),
                              var(dif_mean_vsn_hp_dif),var(dif_mean_cl_hp_dif),
                              var(dif_mean_quant_hp_mis),
                              var(dif_mean_vsn_hp_mis),
                              var(dif_mean_cl_hp_mis),
                              var(dif_mean_quant_hp_mis_dif),
                              var(dif_mean_vsn_hp_mis_dif),
                              var(dif_mean_cl_hp_mis_dif)),
                            c(mean(mse_quant_mean_hp),mean(mse_vsn_mean_hp),
                              mean(mse_cl_mean_hp),mean(mse_quant_mean_hp_dif),
                              mean(mse_vsn_mean_hp_dif),mean(mse_cl_mean_hp_dif),
                              mean(mse_quant_mean_hp_mis),mean(mse_vsn_mean_hp_mis),
                              mean(mse_cl_mean_hp_mis),
                              mean(mse_quant_mean_hp_mis_dif),
                              mean(mse_vsn_mean_hp_mis_dif),
                              mean(mse_cl_mean_hp_mis_dif)),
                            c(var(mse_quant_mean_hp),var(mse_vsn_mean_hp),
                              var(mse_cl_mean_hp),var(mse_quant_mean_hp_dif),
                              var(mse_vsn_mean_hp_dif),var(mse_cl_mean_hp_dif),
                              var(mse_quant_mean_hp_mis),var(mse_vsn_mean_hp_mis),
                              var(mse_cl_mean_hp_mis),
                              var(mse_quant_mean_hp_mis_dif),
                              var(mse_vsn_mean_hp_mis_dif),
                              var(mse_cl_mean_hp_mis_dif)),
                            c(mean(mse_quant_var_hp),mean(mse_vsn_var_hp),
                              mean(mse_cl_var_hp),mean(mse_quant_var_hp_dif),
                              mean(mse_vsn_var_hp_dif),mean(mse_cl_var_hp_dif),
                              mean(mse_quant_var_hp_mis),mean(mse_vsn_var_hp_mis),
                              mean(mse_cl_var_hp_mis),mean(mse_quant_var_hp_mis_dif),
                              mean(mse_vsn_var_hp_mis_dif),
                              mean(mse_cl_var_hp_mis_dif)),
                            c(var(mse_quant_var_hp),var(mse_vsn_var_hp),
                              var(mse_cl_var_hp),var(mse_quant_var_hp_dif),
                              var(mse_vsn_var_hp_dif),var(mse_cl_var_hp_dif),
                              var(mse_quant_var_hp_mis),var(mse_vsn_var_hp_mis),
                              var(mse_cl_var_hp_mis),var(mse_quant_var_hp_mis_dif),
                              var(mse_vsn_var_hp_mis_dif),
                              var(mse_cl_var_hp_mis_dif))))


write.csv(table_hp, "sim_BA_results_hp.csv")

```